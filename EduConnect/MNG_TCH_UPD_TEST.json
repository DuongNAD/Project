{
  "name": "MNG_TCH_UPD_TEST",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "b26e866c-21f6-4c72-a915-abbc40108497",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -800,
        80
      ],
      "id": "3e368bb0-e7d1-4567-acdb-97a57fe28f0b",
      "name": "Webhook",
      "webhookId": "b26e866c-21f6-4c72-a915-abbc40108497"
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "Admin_Registry",
        "filter": {
          "whatToSearch": "folders"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -384,
        80
      ],
      "id": "072e5d60-02e1-4948-8c0e-625e9acc631d",
      "name": "Search files and folders",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Edit Fields').first().json['Danh s√°ch gi√°o vi√™n'] }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Trang t√≠nh1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1YVq0hfeYJHWOWhCGlRifgyg0KchomqRYApVAlQaFl8A/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "M√£ gi√°o vi√™n": "={{ $('Edit Fields').first().json.MaGiaoVien }}",
            "H·ªç v√† t√™n": "={{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }}",
            "M√¥n d·∫°y ch√≠nh": "={{ $('Edit Fields').first().json['M√¥n d·∫°y ch√≠nh'] }}",
            "C√°c l·ªõp gi·∫£ng d·∫°y": "={{ $('Edit Fields').first().json['C√°c l·ªõp gi·∫£ng d·∫°y'] }}",
            "Gi·ªõi t√≠nh": "={{ $('Edit Fields').first().json['Gi·ªõi t√≠nh'] }}",
            "NƒÉm sinh": "={{ $('Edit Fields').first().json['NƒÉm sinh'] }}",
            "S·ªë ƒëi·ªán tho·∫°i": "={{ $('Edit Fields').first().json['S·ªë ƒëi·ªán tho·∫°i'] }}",
            "ƒê·ªãa ch·ªâ li√™n h·ªá": "={{ $('Edit Fields').first().json['ƒê·ªãa ch·ªâ li√™n h·ªá'] }}",
            "FolderId": "={{ $('Create folder').item.json.id }}",
            "ƒê·ªãa ch·ªâ Gmail": "={{ $('Edit Fields').first().json.Gmail }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "M√£ gi√°o vi√™n",
              "displayName": "M√£ gi√°o vi√™n",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "H·ªç v√† t√™n",
              "displayName": "H·ªç v√† t√™n",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ƒê·ªãa ch·ªâ Gmail",
              "displayName": "ƒê·ªãa ch·ªâ Gmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "M√¥n d·∫°y ch√≠nh",
              "displayName": "M√¥n d·∫°y ch√≠nh",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "C√°c l·ªõp gi·∫£ng d·∫°y",
              "displayName": "C√°c l·ªõp gi·∫£ng d·∫°y",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Gi·ªõi t√≠nh",
              "displayName": "Gi·ªõi t√≠nh",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "NƒÉm sinh",
              "displayName": "NƒÉm sinh",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "S·ªë ƒëi·ªán tho·∫°i",
              "displayName": "S·ªë ƒëi·ªán tho·∫°i",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ƒê·ªãa ch·ªâ li√™n h·ªá",
              "displayName": "ƒê·ªãa ch·ªâ li√™n h·ªá",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "FolderId",
              "displayName": "FolderId",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        1600,
        80
      ],
      "id": "75b98f51-52f9-4565-a562-20f29a4d2a60",
      "name": "Append row in sheet",
      "executeOnce": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a71561ac-526e-4f08-a424-27c2c89e4643",
              "name": "MaGiaoVien",
              "value": "={{ $json.body.MaGiaoVien.trim().toUpperCase() }}",
              "type": "string"
            },
            {
              "id": "a12c7a0d-9b40-412a-9f62-30c052f0eda4",
              "name": "M√£ gi√°o vi√™n c·∫≠p nh·∫≠t",
              "value": "={{ $json.body['M√£ Gi√°o Vi√™n (N·∫øu c·∫≠p nh·∫≠t th√¥ng tin, vui l√≤ng nh·∫≠p m√£ c·ªßa b·∫°n t·∫°i ƒë√¢y)'].toUpperCase().trim() }}",
              "type": "string"
            },
            {
              "id": "6c7758c1-4739-49fb-9a8f-64daed818d95",
              "name": "H·ªç v√† t√™n",
              "value": "={{ ($json.body['H·ªç v√† t√™n'] || '').toLowerCase().trim().replace(/\\s+/g, ' ').split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ') }}",
              "type": "string"
            },
            {
              "id": "13092dde-e81e-4636-8943-48584cfb02a9",
              "name": "Gmail",
              "value": "={{ $json.body['ƒê·ªãa ch·ªâ Gmail'].toLowerCase().trim() }}",
              "type": "string"
            },
            {
              "id": "1435fb15-9b2f-4139-bd99-d68ea1787907",
              "name": "M√¥n d·∫°y ch√≠nh",
              "value": "={{ $json.body['M√¥n d·∫°y ch√≠nh'] }}",
              "type": "string"
            },
            {
              "id": "b8cbccb7-ab77-41c0-a613-fef295fcb012",
              "name": "C√°c l·ªõp gi·∫£ng d·∫°y",
              "value": "={{ $json.body['C√°c l·ªõp gi·∫£ng d·∫°y'].toUpperCase() }}",
              "type": "string"
            },
            {
              "id": "f2d9851e-bf8b-4370-b6fe-8c669578844e",
              "name": "Gi·ªõi t√≠nh",
              "value": "={{ $json.body['Gi·ªõi t√≠nh'] }}",
              "type": "string"
            },
            {
              "id": "aa1e1faa-a4b4-41bd-af07-eb4ad56c3fbd",
              "name": "NƒÉm sinh",
              "value": "={{ DateTime.fromISO($json.body['NƒÉm sinh']).toFormat('dd/MM/yyyy') }}",
              "type": "string"
            },
            {
              "id": "b9dd2414-f1a0-465e-9550-ba7bce7a533e",
              "name": "S·ªë ƒëi·ªán tho·∫°i",
              "value": "={{ $json.body['S·ªë ƒëi·ªán tho·∫°i'].trim() }}",
              "type": "string"
            },
            {
              "id": "f1e54efd-cbc0-4868-9f2d-b1adb5ea3e8f",
              "name": "ƒê·ªãa ch·ªâ li√™n h·ªá",
              "value": "={{ $json.body['ƒê·ªãa ch·ªâ li√™n h·ªá'] }}",
              "type": "string"
            },
            {
              "id": "d1649734-b69f-4f82-b848-b623e9f5f9e6",
              "name": "googleFormId",
              "value": "={{ $json.body.formId }}",
              "type": "string"
            },
            {
              "id": "2957cdb2-66d7-430a-bff9-5af5c434e253",
              "name": "Danh s√°ch gi√°o vi√™n",
              "value": "={{ $json.body.spreadsheetId }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -592,
        80
      ],
      "id": "dd22ce1f-55af-4fb4-be12-be83677cc803",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "operation": "share",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Create folder').item.json.id }}",
          "mode": "id"
        },
        "permissionsUi": {
          "permissionsValues": {
            "role": "reader",
            "type": "user",
            "emailAddress": "={{ $('Edit Fields').first().json.Gmail }}"
          }
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        2864,
        80
      ],
      "id": "8c056b3c-ddd6-45c9-a29c-b459fe8d8d9b",
      "name": "Share file",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "aaf29a9d-3228-4cae-9be9-2f93f4e07922",
              "name": "Admin_Registry_folder",
              "value": "={{ $('Search files and folders').first().json.id }}",
              "type": "string"
            },
            {
              "id": "d39472dc-58ac-4c67-8577-f49019749e31",
              "name": "FOLDER_Teacher",
              "value": "={{ $('Search files and folders1').item.json.id }}",
              "type": "string"
            },
            {
              "id": "fb02f9a2-b32c-45b4-b48c-6f3016afe16e",
              "name": "Form(m·∫´u) T·∫°o b√†i t·∫≠p v·ªÅ nh√†",
              "value": "={{ $json.id }}",
              "type": "string"
            },
            {
              "id": "4a4afed6-ac9c-41c7-b6fb-1549d6b6fd74",
              "name": "Folder Teacher Resources",
              "value": "={{ $('Search files and folders2').item.json.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1168,
        80
      ],
      "id": "67858659-e6ad-4dd7-848a-bb14bd3105a8",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "sendTo": "={{ $('Edit Fields').first().json.Gmail }}",
        "subject": "=X√°c nh·∫≠n ƒëƒÉng k√Ω th√¥ng tin th√†nh c√¥ng - {{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }}",
        "message": "=<div style=\"font-family: Arial, sans-serif; color: #333; line-height: 1.6; max-width: 600px; margin: 0 auto; border: 1px solid #ddd;\">\n  \n  <span style=\"display:none; font-size:1px; color:#ffffff; line-height:1px; max-height:0px; max-width:0px; opacity:0; overflow:hidden;\">\n    X√°c nh·∫≠n th√¥ng tin th√†nh c√¥ng & h∆∞·ªõng d·∫´n truy c·∫≠p c√°c ch·ª©c nƒÉng.\n  </span>\n\n  <div style=\"background-color: #0056d6; color: white; padding: 20px; text-align: center;\">\n    <h2 style=\"margin: 0;\">H·ªá th·ªëng Tr·ª£ l√Ω h·ªçc t·∫≠p ·∫£o</h2>\n  </div>\n\n  <div style=\"padding: 20px;\">\n    <p>K√≠nh g·ª≠i Th·∫ßy/C√¥ <strong>{{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }}</strong>,</p>\n    <p>H·ªá th·ªëng xin tr√¢n tr·ªçng th√¥ng b√°o Th·∫ßy/C√¥ ƒë√£ ƒëƒÉng k√Ω/c·∫≠p nh·∫≠t th√¥ng tin c√° nh√¢n th√†nh c√¥ng. Vui l√≤ng ki·ªÉm tra l·∫°i c√°c th√¥ng tin ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n d∆∞·ªõi ƒë√¢y.</p>\n    \n    <h3 style=\"color:#0056d6; border-bottom: 2px solid #0056d6; padding-bottom: 5px;\">B·∫£ng t√≥m t·∫Øt th√¥ng tin</h3>\n    <table style=\"width: 100%; border-collapse: collapse; margin-top: 15px;\">\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; width: 150px;\"><strong>H·ªç v√† t√™n:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px;\"><strong>M√£ gi√°o vi√™n:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json.MaGiaoVien }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px;\"><strong>Email li√™n h·ªá:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json.Gmail }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px;\"><strong>M√¥n d·∫°y ch√≠nh:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json['M√¥n d·∫°y ch√≠nh'] }}</td>\n      </tr>\n      <tr>\n        <td style=\"padding: 10px;\"><strong>C√°c l·ªõp gi·∫£ng d·∫°y:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json['C√°c l·ªõp gi·∫£ng d·∫°y'] }}</td>\n      </tr>\n    </table>\n    \n    <div style=\"margin-top: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 5px; background-color: #f9f9f9;\">\n      <h3 style=\"color:#0056d6; margin-top: 0; text-align: center; border-bottom: 2px solid #0056d6; padding-bottom: 10px;\">B·∫£ng ƒëi·ªÅu khi·ªÉn T√°c v·ª• nhanh</h3>\n      \n      <div style=\"margin-top: 15px; text-align: center;\">\n        <p style=\"margin-bottom: 12px;\">Th·∫ßy/C√¥ c√≥ th·ªÉ xem tr∆∞·ªõc form, ho·∫∑c <strong>sao ch√©p ƒë∆∞·ªùng d·∫´n</strong> d∆∞·ªõi ƒë√¢y ƒë·ªÉ g·ª≠i cho h·ªçc sinh:</p>\n        \n        <p style=\"margin-bottom: 15px;\">\n            <code style=\"background-color: #eef1f6; padding: 10px 15px; border: 1px solid #d1d9e6; border-radius: 4px; font-family: 'Courier New', Courier, monospace; color: #333; word-break: break-all; display: inline-block; text-align: left;\">https://docs.google.com/forms/d/{{ $('Create googleForm ƒëƒÉng k√Ω th√¥ng tin h·ªçc sinh').item.json.formId }}/viewform</code>\n        </p>\n\n        <a href=\"https://docs.google.com/forms/d/{{ $('Create googleForm ƒëƒÉng k√Ω th√¥ng tin h·ªçc sinh').item.json.formId }}/viewform\" target=\"_blank\" style=\"display: inline-block; background-color: #28a745; color: #ffffff; padding: 12px 25px; text-decoration: none; border-radius: 5px; font-weight: bold;\">\n          XEM TR∆Ø·ªöC FORM H·ªåC SINH\n        </a>\n      </div>\n      <div style=\"margin-top: 25px; text-align: center;\">\n        <p style=\"margin-bottom: 10px;\"><strong>ƒê·ªÉ giao b√†i t·∫≠p v·ªÅ nh√† m·ªõi, Th·∫ßy/C√¥ h√£y nh·∫•p v√†o n√∫t d∆∞·ªõi ƒë√¢y:</strong></p>\n        <a href=\"https://docs.google.com/forms/d/{{ $('Create googleForm b√†i t·∫≠p v·ªÅ nh√†').item.json.formId }}/viewform\" target=\"_blank\" style=\"display: inline-block; background-color: #17a2b8; color: #ffffff; padding: 12px 25px; text-decoration: none; border-radius: 5px; font-weight: bold;\">\n          GIAO B√ÄI T·∫¨P M·ªöI\n        </a>\n      </div>\n    </div>\n        <div style=\"background-color: #fffbe6; border: 1px solid #fdec9a; padding: 15px; border-radius: 5px; text-align: center; margin-top: 30px;\">\n        <p style=\"margin-top: 0;\">N·∫øu c√≥ b·∫•t k·ª≥ sai s√≥t n√†o trong b·∫£ng t√≥m t·∫Øt th√¥ng tin, Th·∫ßy/C√¥ c√≥ th·ªÉ nh·∫•p v√†o n√∫t d∆∞·ªõi ƒë√¢y ƒë·ªÉ s·ª≠a.</p>\n        <a href=\"https://docs.google.com/forms/d/{{ $('Edit Fields').first().json.googleFormId }}/viewform\" target=\"_blank\" style=\"display: inline-block; background-color: #0056d6; color: #ffffff; padding: 12px 25px; text-decoration: none; border-radius: 5px; font-weight: bold; margin-top: 5px;\">\n            CH·ªàNH S·ª¨A TH√îNG TIN\n        </a>\n      </div>\n    \n    <br>\n    <p>Tr√¢n tr·ªçng,</p>\n    <p><strong>ƒê·ªôi ng≈© Tr·ª£ l√Ω h·ªçc t·∫≠p ·∫£o</strong></p>\n  </div>\n\n  <div style=\"background-color: #f4f4f4; padding: 10px; text-align: center; font-size: 12px; color: #666;\">\n    <p>ƒê√¢y l√† email ƒë∆∞·ª£c g·ª≠i t·ª± ƒë·ªông t·ª´ h·ªá th·ªëng. Vui l√≤ng kh√¥ng tr·∫£ l·ªùi tr·ª±c ti·∫øp.</p>\n  </div>\n</div>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        3072,
        80
      ],
      "id": "a63a84e8-9327-48e0-a043-e4552c9c934a",
      "name": "Send a message",
      "webhookId": "a74de3be-5a76-4523-8ded-73dad5850e7f",
      "executeOnce": true,
      "credentials": {
        "gmailOAuth2": {
          "id": "kngvm6WXlbqXMFKV",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "FOLDER_Teachers",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Search files and folders').first().json.id }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        544,
        80
      ],
      "id": "a24065c3-b396-4f64-aa84-640e4c8ef87a",
      "name": "Search files and folders1",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "[Admin] Teacher Resources",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Search files and folders').first().json.id }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        752,
        80
      ],
      "id": "ebca2b0d-bd2f-49ce-97c1-c8056e5d32b7",
      "name": "Search files and folders2",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "T·∫°o b√†i t·∫≠p v·ªÅ nh√†",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $json.id }}",
            "mode": "id"
          },
          "whatToSearch": "files",
          "fileTypes": [
            "application/vnd.google-apps.form"
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        960,
        80
      ],
      "id": "64f914da-5295-404e-a513-0a2186ff1193",
      "name": "Search files and folders3",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbzJ4Ajx901CvDvDMIeLeOCfdCf5B0FBRaKpY3oMl-068uWifsvR8GxAfzMiyuSUvJwXtA/exec",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"destinationFolderId\": \"{{ $('Create folder').item.json.id }}\",\n  \"newFormName\": \"B√†i t·∫≠p v·ªÅ nh√† - {{ $json['M√¥n d·∫°y ch√≠nh'] }}\",\n  \"templateFormId\": \"{{ $('Edit Fields1').item.json['Form(m·∫´u) T·∫°o b√†i t·∫≠p v·ªÅ nh√†'] }}\"\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1808,
        80
      ],
      "id": "f658f3d7-b4b5-409f-bc47-7b215f50f5d1",
      "name": "Create googleForm b√†i t·∫≠p v·ªÅ nh√†"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbxEhq6T0VGqQlEyCl4F7hmqnrATKEKu3SaTK2g9evIxWkzd3RLUwhOJBWr7MXVt4CO7/exec",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"formTitle\": \"Form ƒêƒÉng K√Ω H·ªçc Sinh\",\n  \"folderId\": \"{{ $('Create folder').item.json.id }}\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2016,
        80
      ],
      "id": "a270e994-83e8-45d6-a403-9621c6083e19",
      "name": "Create googleForm ƒëƒÉng k√Ω th√¥ng tin h·ªçc sinh"
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "={{ $('Edit Fields').first().json.MaGiaoVien }} - {{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('Edit Fields1').item.json.FOLDER_Teacher }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1376,
        80
      ],
      "id": "9da3adfe-4366-4eae-8369-3f982f0e905b",
      "name": "Create folder",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Edit Fields').first().json['Danh s√°ch gi√°o vi√™n'] }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Trang t√≠nh1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EUoCixELpOS8X8RNM1XAOC2abn6Ul_FdxTZqOU4GPU8/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "M√£ gi√°o vi√™n": "={{ $('Edit Fields').first().json['M√£ gi√°o vi√™n c·∫≠p nh·∫≠t'] }}",
            "H·ªç v√† t√™n": "={{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }}",
            "C√°c l·ªõp gi·∫£ng d·∫°y": "={{ $('Edit Fields').first().json['C√°c l·ªõp gi·∫£ng d·∫°y'] }}",
            "M√¥n d·∫°y ch√≠nh": "={{ $('Edit Fields').first().json['M√¥n d·∫°y ch√≠nh'] }}",
            "Gi·ªõi t√≠nh": "={{ $('Edit Fields').first().json['Gi·ªõi t√≠nh'] }}",
            "NƒÉm sinh": "={{ $('Edit Fields').first().json['NƒÉm sinh'] }}",
            "S·ªë ƒëi·ªán tho·∫°i": "={{ $('Edit Fields').first().json['S·ªë ƒëi·ªán tho·∫°i'] }}",
            "ƒê·ªãa ch·ªâ li√™n h·ªá": "={{ $('Edit Fields').first().json['ƒê·ªãa ch·ªâ li√™n h·ªá'] }}",
            "ƒê·ªãa ch·ªâ Gmail": "={{ $('Edit Fields').first().json.Gmail }}"
          },
          "matchingColumns": [
            "M√£ gi√°o vi√™n"
          ],
          "schema": [
            {
              "id": "M√£ gi√°o vi√™n",
              "displayName": "M√£ gi√°o vi√™n",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "H·ªç v√† t√™n",
              "displayName": "H·ªç v√† t√™n",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ƒê·ªãa ch·ªâ Gmail",
              "displayName": "ƒê·ªãa ch·ªâ Gmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "M√¥n d·∫°y ch√≠nh",
              "displayName": "M√¥n d·∫°y ch√≠nh",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "C√°c l·ªõp gi·∫£ng d·∫°y",
              "displayName": "C√°c l·ªõp gi·∫£ng d·∫°y",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Gi·ªõi t√≠nh",
              "displayName": "Gi·ªõi t√≠nh",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "NƒÉm sinh",
              "displayName": "NƒÉm sinh",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "S·ªë ƒëi·ªán tho·∫°i",
              "displayName": "S·ªë ƒëi·ªán tho·∫°i",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ƒê·ªãa ch·ªâ li√™n h·ªá",
              "displayName": "ƒê·ªãa ch·ªâ li√™n h·ªá",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "FolderId",
              "displayName": "FolderId",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1168,
        256
      ],
      "id": "685188ba-17da-4116-bc56-373f214e1585",
      "name": "Update row in sheet1",
      "executeOnce": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "operation": "share",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Switch').first().json.existing_folder_id }}",
          "mode": "id"
        },
        "permissionsUi": {
          "permissionsValues": {
            "role": "reader",
            "type": "user",
            "emailAddress": "={{ $('Edit Fields').first().json.Gmail }}"
          }
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        2432,
        256
      ],
      "id": "6cd4acf0-47de-419e-bcf6-899f024c5878",
      "name": "Share file2",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $('Edit Fields').first().json.Gmail }}",
        "subject": "=X√°c nh·∫≠n ƒëƒÉng k√Ω th√¥ng tin th√†nh c√¥ng - {{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }}",
        "message": "=<div style=\"font-family: Arial, sans-serif; color: #333; line-height: 1.6; max-width: 600px; margin: 0 auto; border: 1px solid #ddd;\">\n  \n  <span style=\"display:none; font-size:1px; color:#ffffff; line-height:1px; max-height:0px; max-width:0px; opacity:0; overflow:hidden;\">\n    X√°c nh·∫≠n th√¥ng tin th√†nh c√¥ng & h∆∞·ªõng d·∫´n truy c·∫≠p c√°c ch·ª©c nƒÉng.\n  </span>\n\n  <div style=\"background-color: #0056d6; color: white; padding: 20px; text-align: center;\">\n    <h2 style=\"margin: 0;\">H·ªá th·ªëng Tr·ª£ l√Ω h·ªçc t·∫≠p ·∫£o</h2>\n  </div>\n\n  <div style=\"padding: 20px;\">\n    <p>K√≠nh g·ª≠i Th·∫ßy/C√¥ <strong>{{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }}</strong>,</p>\n    <p>H·ªá th·ªëng xin tr√¢n tr·ªçng th√¥ng b√°o Th·∫ßy/C√¥ ƒë√£ ƒëƒÉng k√Ω/c·∫≠p nh·∫≠t th√¥ng tin c√° nh√¢n th√†nh c√¥ng. Vui l√≤ng ki·ªÉm tra l·∫°i c√°c th√¥ng tin ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n d∆∞·ªõi ƒë√¢y.</p>\n    \n    <h3 style=\"color:#0056d6; border-bottom: 2px solid #0056d6; padding-bottom: 5px;\">B·∫£ng t√≥m t·∫Øt th√¥ng tin</h3>\n    <table style=\"width: 100%; border-collapse: collapse; margin-top: 15px;\">\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; width: 150px;\"><strong>H·ªç v√† t√™n:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px;\"><strong>M√£ gi√°o vi√™n:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json.MaGiaoVien }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px;\"><strong>Email li√™n h·ªá:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json.Gmail }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px;\"><strong>M√¥n d·∫°y ch√≠nh:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json['M√¥n d·∫°y ch√≠nh'] }}</td>\n      </tr>\n      <tr>\n        <td style=\"padding: 10px;\"><strong>C√°c l·ªõp gi·∫£ng d·∫°y:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json['C√°c l·ªõp gi·∫£ng d·∫°y'] }}</td>\n      </tr>\n    </table>\n    \n    <div style=\"margin-top: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 5px; background-color: #f9f9f9;\">\n      <h3 style=\"color:#0056d6; margin-top: 0; text-align: center; border-bottom: 2px solid #0056d6; padding-bottom: 10px;\">B·∫£ng ƒëi·ªÅu khi·ªÉn T√°c v·ª• nhanh</h3>\n      \n      <div style=\"margin-top: 15px; text-align: center;\">\n        <p style=\"margin-bottom: 12px;\">Th·∫ßy/C√¥ c√≥ th·ªÉ xem tr∆∞·ªõc form, ho·∫∑c <strong>sao ch√©p ƒë∆∞·ªùng d·∫´n</strong> d∆∞·ªõi ƒë√¢y ƒë·ªÉ g·ª≠i cho h·ªçc sinh:</p>\n        \n        <p style=\"margin-bottom: 15px;\">\n            <code style=\"background-color: #eef1f6; padding: 10px 15px; border: 1px solid #d1d9e6; border-radius: 4px; font-family: 'Courier New', Courier, monospace; color: #333; word-break: break-all; display: inline-block; text-align: left;\">https://docs.google.com/forms/d/{{ $('Code in JavaScript').item.json.my_file_list[1].id }}/viewform</code>\n        </p>\n\n        <a href=\"https://docs.google.com/forms/d/{{ $('Code in JavaScript').item.json.my_file_list[1].id }}/viewform\" target=\"_blank\" style=\"display: inline-block; background-color: #28a745; color: #ffffff; padding: 12px 25px; text-decoration: none; border-radius: 5px; font-weight: bold;\">\n          XEM TR∆Ø·ªöC FORM ƒêƒÇNG K√ù H·ªåC SINH\n        </a>\n      </div>\n      <div style=\"margin-top: 25px; text-align: center;\">\n        <p style=\"margin-bottom: 10px;\"><strong>ƒê·ªÉ giao b√†i t·∫≠p v·ªÅ nh√† m·ªõi, Th·∫ßy/C√¥ h√£y nh·∫•p v√†o n√∫t d∆∞·ªõi ƒë√¢y:</strong></p>\n        <a href=\"https://docs.google.com/forms/d/{{ $('Code in JavaScript').item.json.my_file_list[0].id }}/viewform\" target=\"_blank\" style=\"display: inline-block; background-color: #17a2b8; color: #ffffff; padding: 12px 25px; text-decoration: none; border-radius: 5px; font-weight: bold;\">\n          GIAO B√ÄI T·∫¨P M·ªöI\n        </a>\n      </div>\n    </div>\n        <div style=\"background-color: #fffbe6; border: 1px solid #fdec9a; padding: 15px; border-radius: 5px; text-align: center; margin-top: 30px;\">\n        <p style=\"margin-top: 0;\">N·∫øu c√≥ b·∫•t k·ª≥ sai s√≥t n√†o trong b·∫£ng t√≥m t·∫Øt th√¥ng tin, Th·∫ßy/C√¥ c√≥ th·ªÉ nh·∫•p v√†o n√∫t d∆∞·ªõi ƒë√¢y ƒë·ªÉ s·ª≠a.</p>\n        <a href=\"https://docs.google.com/forms/d/{{ $('Edit Fields').first().json.googleFormId }}/viewform\" target=\"_blank\" style=\"display: inline-block; background-color: #0056d6; color: #ffffff; padding: 12px 25px; text-decoration: none; border-radius: 5px; font-weight: bold; margin-top: 5px;\">\n            CH·ªàNH S·ª¨A TH√îNG TIN\n        </a>\n      </div>\n    \n    <br>\n    <p>Tr√¢n tr·ªçng,</p>\n    <p><strong>ƒê·ªôi ng≈© Tr·ª£ l√Ω h·ªçc t·∫≠p ·∫£o</strong></p>\n  </div>\n\n  <div style=\"background-color: #f4f4f4; padding: 10px; text-align: center; font-size: 12px; color: #666;\">\n    <p>ƒê√¢y l√† email ƒë∆∞·ª£c g·ª≠i t·ª± ƒë·ªông t·ª´ h·ªá th·ªëng. Vui l√≤ng kh√¥ng tr·∫£ l·ªùi tr·ª±c ti·∫øp.</p>\n  </div>\n</div>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2640,
        256
      ],
      "id": "4501e0e9-d21c-41b5-86b3-2a6eb3316196",
      "name": "Send a message1",
      "webhookId": "a74de3be-5a76-4523-8ded-73dad5850e7f",
      "executeOnce": true,
      "credentials": {
        "gmailOAuth2": {
          "id": "kngvm6WXlbqXMFKV",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbzJ4Ajx901CvDvDMIeLeOCfdCf5B0FBRaKpY3oMl-068uWifsvR8GxAfzMiyuSUvJwXtA/exec",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"destinationFolderId\": \"{{ $('Switch').item.json.existing_folder_id }}\",\n  \"newFormName\": \"B√†i t·∫≠p v·ªÅ nh√† - {{ $('Edit Fields').item.json['M√¥n d·∫°y ch√≠nh'] }}\",\n  \"templateFormId\": \"{{ $('Search files and folders8').first().json.id }}\" \n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1808,
        256
      ],
      "id": "42089634-1392-4258-85c0-96f9b74bf914",
      "name": "Create googleForm b√†i t·∫≠p v·ªÅ nh√†2"
    },
    {
      "parameters": {
        "operation": "deleteFile",
        "fileId": {
          "__rl": true,
          "value": "={{ $json.id }}",
          "mode": "id"
        },
        "options": {
          "deletePermanently": false
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        960,
        256
      ],
      "id": "2340cbab-16dc-4fe9-a5b9-bd7666c8ca51",
      "name": "Delete a file",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "={{ $('Edit Fields').item.json['Danh s√°ch gi√°o vi√™n'] }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Trang t√≠nh1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EUoCixELpOS8X8RNM1XAOC2abn6Ul_FdxTZqOU4GPU8/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -192,
        80
      ],
      "id": "ac78fccf-c3cf-4c05-b745-116498745532",
      "name": "Get row(s) in sheet",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "searchMethod": "query",
        "queryString": "=",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $json.existing_folder_id }}",
            "mode": "id"
          },
          "whatToSearch": "files",
          "fileTypes": [
            "application/vnd.google-apps.form"
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        544,
        336
      ],
      "id": "3c3cd6bb-7a1d-436c-921a-c578d537aefc",
      "name": "Search files and folders5",
      "alwaysOutputData": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $('Edit Fields').first().json.Gmail }}",
        "subject": "[H·ªÜ TH·ªêNG] Th√¥ng b√°o v·ªÅ y√™u c·∫ßu C·∫≠p nh·∫≠t/ƒêƒÉng k√Ω Gi√°o vi√™n",
        "message": "=<p>K√≠nh g·ª≠i th·∫ßy/c√¥ <b>{{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }}</b>,</p>\n\n<p>H·ªá th·ªëng ghi nh·∫≠n th·∫ßy/c√¥ v·ª´a th·ª±c hi·ªán y√™u c·∫ßu C·∫≠p nh·∫≠t ho·∫∑c ƒêƒÉng k√Ω th√¥ng tin gi√°o vi√™n.</p>\n\n<p>Tuy nhi√™n, y√™u c·∫ßu n√†y <b>CH∆ØA TH√ÄNH C√îNG</b> do nguy√™n nh√¢n sau:</p>\n\n<blockquote style=\"background-color: #f9d7da; border-left: 5px solid #d9534f; padding: 10px; color: #721c24;\">\n    <b>{{ $json.workflow_message }}</b>\n</blockquote>\n\n<p>ƒê·ªÉ x·ª≠ l√Ω v·∫•n ƒë·ªÅ n√†y, th·∫ßy/c√¥ vui l√≤ng nh·∫•n v√†o n√∫t d∆∞·ªõi ƒë√¢y ƒë·ªÉ m·ªü l·∫°i bi·ªÉu m·∫´u v√† ƒëi·ªÅn l·∫°i th√¥ng tin ch√≠nh x√°c:</p>\n\n<div style=\"text-align: center; margin: 25px 0;\">\n    <a href=\"https://docs.google.com/forms/d/{{ $json.googleFormId }}/viewform\" \n       style=\"background-color: #1a73e8; color: #ffffff; padding: 12px 24px; text-decoration: none; border-radius: 5px; font-weight: bold; font-family: Arial, sans-serif; font-size: 16px;\">\n       üëâ M·ªû L·∫†I FORM ƒêƒÇNG K√ù\n    </a>\n</div>\n\n<p><i>L∆∞u √Ω: N·∫øu th·∫ßy/c√¥ ƒëang mu·ªën c·∫≠p nh·∫≠t th√¥ng tin, h√£y nh·ªõ nh·∫≠p ch√≠nh x√°c <b>M√£ Gi√°o Vi√™n</b> c·ªßa m√¨nh.</i></p>\n\n<p>Tr√¢n tr·ªçng,<br>\n<b>Admin System</b></p>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        544,
        -128
      ],
      "id": "10b37728-f63f-4f1c-bc68-d586c3970ff7",
      "name": "Send a message3",
      "webhookId": "13b7c630-d5df-4102-b58e-dcb031825a6f",
      "credentials": {
        "gmailOAuth2": {
          "id": "kngvm6WXlbqXMFKV",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "[ADMIN] Master Control Sheet",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Search files and folders').first().json.id }}",
            "mode": "id"
          },
          "whatToSearch": "files",
          "fileTypes": [
            "application/vnd.google-apps.spreadsheet"
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        2224,
        80
      ],
      "id": "d70962b2-7bc1-4f4e-81bb-340cb0450deb",
      "name": "Search files and folders6",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders6').item.json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Teachers",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "TeacherID": "={{ $json.TeacherID }}",
            "TeacherName": "={{ $json.TeacherName }}",
            "TeacherFolderID": "={{ $json.TeacherFolderID }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "TeacherID",
              "displayName": "TeacherID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "TeacherName",
              "displayName": "TeacherName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "TeacherFolderID",
              "displayName": "TeacherFolderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2640,
        80
      ],
      "id": "c14ab7eb-7d25-47d4-a3c0-106ad8282793",
      "name": "Append row in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ===== 1. L·∫§Y D·ªÆ LI·ªÜU T·ª™ C√ÅC B∆Ø·ªöC TR∆Ø·ªöC =====\n\n// L·∫•y th√¥ng tin chi ti·∫øt c·ªßa gi√°o vi√™n t·ª´ node Edit Fields\n// H√£y ƒë·ªïi 'Edit Fields' th√†nh t√™n node th·ª±c t·∫ø c·ªßa anh\nconst teacherInfo = $('Edit Fields').first().json;\n\n// L·∫•y th√¥ng tin c·ªßa th∆∞ m·ª•c v·ª´a ƒë∆∞·ª£c t·∫°o\n// H√£y ƒë·ªïi 'Create folder' th√†nh t√™n node th·ª±c t·∫ø c·ªßa anh\nconst folderInfo = $('Create folder').first().json;\n\n\n// ===== 2. T·∫†O ƒê·ªêI T∆Ø·ª¢NG D·ªÆ LI·ªÜU M·ªöI =====\n// ƒê·ªëi t∆∞·ª£ng n√†y c√≥ c√°c tr∆∞·ªùng kh·ªõp ch√≠nh x√°c v·ªõi t√™n c·ªôt trong Sheet\n\nconst newRow = {\n  TeacherID: teacherInfo.MaGiaoVien,\n  TeacherName: teacherInfo['H·ªç v√† t√™n'], // D√πng d·∫•u ngo·∫∑c v√¨ c√≥ kho·∫£ng tr·∫Øng\n  TeacherFolderID: folderInfo.id\n};\n\n\n// ===== 3. TR·∫¢ V·ªÄ K·∫æT QU·∫¢ =====\n// Tr·∫£ v·ªÅ m·ªôt item duy nh·∫•t ch·ª©a d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c chu·∫©n h√≥a\nreturn [{\n  json: newRow\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2432,
        80
      ],
      "id": "453cd76a-cb57-4285-83fb-55be29b8043a",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "jsCode": "// ============================================================\n// PH·∫¶N 1: L·∫§Y D·ªÆ LI·ªÜU ƒê·∫¶U V√ÄO\n// ============================================================\n\n// 1. L·∫•y d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω t·ª´ node Edit Fields\nconst inputData = $('Edit Fields').first().json; \n\n// 2. L·∫•y d·ªØ li·ªáu t·ª´ Sheet (Node Get row(s))\nconst allTeachers = $('Get row(s) in sheet').all().map(item => item.json);\n\n\n// ============================================================\n// PH·∫¶N 2: CHU·∫®N H√ìA D·ªÆ LI·ªÜU (L·∫§Y TR·ª∞C TI·∫æP T·ª™ NODE SET)\n// ============================================================\n\n// --- S·ª¨A T·∫†I ƒê√ÇY: L·∫•y ƒë√∫ng t√™n tr∆∞·ªùng anh ƒë·∫∑t trong Edit Fields ---\nconst rawUserCode = inputData['M√£ gi√°o vi√™n c·∫≠p nh·∫≠t'];\n\n// L·∫•y \"M√£ t·ª± sinh\" (NAD...)\nconst autoGeneratedCode = inputData['MaGiaoVien']; \n\n// L·∫•y Email\nconst rawEmail = inputData['Gmail'];\n\n// X·ª≠ l√Ω chu·ªói (X√≥a kho·∫£ng tr·∫Øng, v·ªÅ ch·ªØ th∆∞·ªùng)\nconst inputID = rawUserCode ? rawUserCode.toString().trim() : \"\";\nconst inputEmail = rawEmail ? rawEmail.toString().trim().toLowerCase() : \"\";\n\n// Kh·ªüi t·∫°o bi·∫øn k·∫øt qu·∫£\nlet action = '';      \nlet message = '';       \nlet targetRow = null; \nlet finalID = autoGeneratedCode; \nlet currentFolderId = null; \n\n\n// ============================================================\n// PH·∫¶N 3: LOGIC X·ª¨ L√ù CH√çNH\n// ============================================================\n\n// [TR∆Ø·ªúNG H·ª¢P A]: inputID c√≥ d·ªØ li·ªáu (NAD00009) -> UPDATE\nif (inputID !== \"\") {\n    \n    // T√¨m trong Sheet xem c√≥ m√£ NAD00009 kh√¥ng\n    const foundTeacher = allTeachers.find(t => t['M√£ gi√°o vi√™n'] == inputID); \n\n    if (foundTeacher) {\n        // C√≥ m√£ -> Check Email\n        const ownerEmail = foundTeacher['ƒê·ªãa ch·ªâ Gmail'] ? foundTeacher['ƒê·ªãa ch·ªâ Gmail'].toString().trim().toLowerCase() : \"\";\n\n        if (ownerEmail === inputEmail) {\n            // Email kh·ªõp -> UPDATE\n            action = 'UPDATE';\n            targetRow = foundTeacher['row_number']; \n            finalID = inputID; \n            currentFolderId = foundTeacher['FolderId']; \n            \n            message = `X√°c th·ª±c th√†nh c√¥ng. ƒêang c·∫≠p nh·∫≠t cho m√£ ${inputID}.`;\n        } else {\n            // Email l·ªách -> L·ªói b·∫£o m·∫≠t\n            action = 'ERROR';\n            message = `L·ªói b·∫£o m·∫≠t: M√£ \"${inputID}\" thu·ªôc v·ªÅ email kh√°c (${ownerEmail}).`;\n        }\n    } else {\n        // Kh√¥ng t√¨m th·∫•y m√£ trong Sheet -> B√°o l·ªói\n        action = 'ERROR';\n        message = `L·ªói: M√£ gi√°o vi√™n \"${inputID}\" kh√¥ng t·ªìn t·∫°i trong h·ªá th·ªëng.`;\n    }\n\n} \n// [TR∆Ø·ªúNG H·ª¢P B]: inputID r·ªóng -> CREATE\nelse {\n    // Check tr√πng Email\n    const duplicateEmail = allTeachers.find(t => {\n        const sheetEmail = t['ƒê·ªãa ch·ªâ Gmail'] ? t['ƒê·ªãa ch·ªâ Gmail'].toString().trim().toLowerCase() : \"\";\n        return sheetEmail === inputEmail;\n    });\n\n    if (duplicateEmail) {\n        action = 'ERROR';\n        message = `L·ªói: Email \"${inputEmail}\" ƒë√£ t·ªìn t·∫°i.`;\n    } else {\n        action = 'CREATE';\n        message = 'D·ªØ li·ªáu h·ª£p l·ªá. T·∫°o h·ªì s∆° m·ªõi.';\n    }\n}\n\n// ============================================================\n// PH·∫¶N 4: OUTPUT\n// ============================================================\nreturn {\n    json: {\n        ...inputData,              \n        workflow_action: action,       \n        workflow_message: message,     \n        target_row_number: targetRow,  \n        final_teacher_id: finalID,\n        existing_folder_id: currentFolderId,\n        \n        // Debug: Anh xem d√≤ng n√†y output ra g√¨ l√† bi·∫øt ngay\n        debug_check_code: inputID \n    }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        16,
        80
      ],
      "id": "6f4e88cf-2817-4fc8-b455-5d72fbe960e9",
      "name": "Code in JavaScript2",
      "executeOnce": false
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.workflow_action.trim() }}",
                    "rightValue": "ERROR",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "a2706d59-4f7f-4fea-b614-7535194ef596"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "afc9d5b4-3adb-432c-bcde-4ba95aa24790",
                    "leftValue": "={{ $json.workflow_action.trim() }}",
                    "rightValue": "CREATE",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "59b46602-cc65-4c08-a719-b3d60687718e",
                    "leftValue": "={{ $json.workflow_action.trim() }}",
                    "rightValue": "UPDATE",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        224,
        64
      ],
      "id": "a3845364-4708-443e-a117-cce112cd241b",
      "name": "Switch"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "2abc6da1-5ce4-4491-9c2b-644496f307fe",
              "leftValue": "={{ $json.name }}",
              "rightValue": "Form ƒêƒÉng K√Ω H·ªçc Sinh",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        752,
        336
      ],
      "id": "4580e78b-3eb0-421e-a359-1e94ce39c549",
      "name": "If"
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "[Admin] Teacher Resources",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Search files and folders').first().json.id }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1376,
        256
      ],
      "id": "9fc1d816-1fb8-4b2f-87e6-4284edf7d976",
      "name": "Search files and folders7",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "T·∫°o b√†i t·∫≠p v·ªÅ nh√†",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $json.id }}",
            "mode": "id"
          },
          "whatToSearch": "files",
          "fileTypes": [
            "application/vnd.google-apps.form"
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1600,
        256
      ],
      "id": "af5e0786-bdf8-4ee8-983a-7bb686a59ae0",
      "name": "Search files and folders8",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "searchMethod": "query",
        "queryString": "=",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Switch').item.json.existing_folder_id }}",
            "mode": "id"
          },
          "whatToSearch": "files",
          "fileTypes": [
            "application/vnd.google-apps.form"
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        2016,
        256
      ],
      "id": "e79ff6b6-cf43-49f5-b3ce-6f457d213e30",
      "name": "Search files and folders9",
      "alwaysOutputData": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// 1. L·∫•y t·∫•t c·∫£ c√°c items t·ª´ node tr∆∞·ªõc (thay v√¨ ch·∫°y t·ª´ng c√°i)\nconst allItems = $input.all();\n\n// 2. Tr√≠ch xu·∫•t ph·∫ßn d·ªØ li·ªáu JSON ra th√†nh m·ªôt m·∫£ng (Array)\n// Map l√† h√†m duy·ªát qua t·ª´ng ph·∫ßn t·ª≠ ƒë·ªÉ l·∫•y c√°i m√¨nh c·∫ßn\nconst fileList = allItems.map(item => item.json);\n\n// 3. Tr·∫£ v·ªÅ 1 item duy nh·∫•t ch·ª©a danh s√°ch ƒë√≥\nreturn {\n  json: {\n    total_count: fileList.length, // ƒê·∫øm t·ªïng s·ªë file t√¨m ƒë∆∞·ª£c\n    my_file_list: fileList        // Danh s√°ch chi ti·∫øt c√°c file\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2224,
        256
      ],
      "id": "3ba278b1-4bde-4bcb-89a2-11d7f159c20c",
      "name": "Code in JavaScript"
    }
  ],
  "pinData": {},
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Search files and folders",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet": {
      "main": [
        [
          {
            "node": "Create googleForm b√†i t·∫≠p v·ªÅ nh√†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Share file": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Create folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders1": {
      "main": [
        [
          {
            "node": "Search files and folders2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders2": {
      "main": [
        [
          {
            "node": "Search files and folders3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders3": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create googleForm b√†i t·∫≠p v·ªÅ nh√†": {
      "main": [
        [
          {
            "node": "Create googleForm ƒëƒÉng k√Ω th√¥ng tin h·ªçc sinh",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create googleForm ƒëƒÉng k√Ω th√¥ng tin h·ªçc sinh": {
      "main": [
        [
          {
            "node": "Search files and folders6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create folder": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Share file2": {
      "main": [
        [
          {
            "node": "Send a message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create googleForm b√†i t·∫≠p v·ªÅ nh√†2": {
      "main": [
        [
          {
            "node": "Search files and folders9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet1": {
      "main": [
        [
          {
            "node": "Search files and folders7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete a file": {
      "main": [
        [
          {
            "node": "Update row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders5": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders6": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Append row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet1": {
      "main": [
        [
          {
            "node": "Share file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Send a message3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Search files and folders1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Search files and folders5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Delete a file",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "Search files and folders7": {
      "main": [
        [
          {
            "node": "Search files and folders8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders8": {
      "main": [
        [
          {
            "node": "Create googleForm b√†i t·∫≠p v·ªÅ nh√†2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders9": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Share file2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "c6881350-1530-4e8e-8adc-1bb387166ca6",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "df75f6d19da9532b87ea5a84541b4ccc1d0dd5baf896242962b0dfcbc492bcf4"
  },
  "id": "u8W2Dt4NA8LM50Z9",
  "tags": []
}