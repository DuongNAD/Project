{
  "name": "UPDATE th√¥ng tin h·ªçc sinh (c·∫•p 1)",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "4b110b44-9a40-4f14-925f-98e881cdf44e",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -2016,
        80
      ],
      "id": "9375a6ce-2921-4d44-ab0d-469b30b926ce",
      "name": "Webhook",
      "webhookId": "4b110b44-9a40-4f14-925f-98e881cdf44e"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a71561ac-526e-4f08-a424-27c2c89e4643",
              "name": "M√£ h·ªçc sinh",
              "value": "={{ $json.body.StudentID.trim().toUpperCase() }}",
              "type": "string"
            },
            {
              "id": "17c55f73-dbc8-4dc8-af7e-107c1d08fbaf",
              "name": "T√™n tr∆∞·ªùng",
              "value": "={{ $json.body['T√™n tr∆∞·ªùng'].trim() }}",
              "type": "string"
            },
            {
              "id": "6c7758c1-4739-49fb-9a8f-64daed818d95",
              "name": "H·ªç v√† t√™n",
              "value": "={{ ($json.body['H·ªç v√† T√™n'] || '').toLowerCase().trim().replace(/\\s+/g, ' ').split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ') }}",
              "type": "string"
            },
            {
              "id": "13092dde-e81e-4636-8943-48584cfb02a9",
              "name": "Gmail",
              "value": "={{ $json.body.Email.toLowerCase().trim() }}",
              "type": "string"
            },
            {
              "id": "aa1e1faa-a4b4-41bd-af07-eb4ad56c3fbd",
              "name": "Ng√†y th√°ng nƒÉm sinh",
              "value": "={{ DateTime.fromISO($json.body['Ng√†y, th√°ng, nƒÉm sinh']).toFormat('dd/MM/yyyy') }}",
              "type": "string"
            },
            {
              "id": "b8cbccb7-ab77-41c0-a613-fef295fcb012",
              "name": "L·ªõp h·ªçc",
              "value": "={{ $json.body['L·ªõp h·ªçc'].toUpperCase().trim() }}",
              "type": "string"
            },
            {
              "id": "f2d9851e-bf8b-4370-b6fe-8c669578844e",
              "name": "Gi·ªõi t√≠nh",
              "value": "={{ $json.body['Gi·ªõi t√≠nh'] }}",
              "type": "string"
            },
            {
              "id": "b9dd2414-f1a0-465e-9550-ba7bce7a533e",
              "name": "S·ªë ƒëi·ªán tho·∫°i",
              "value": "={{ $json.body['S·ªë ƒëi·ªán tho·∫°i'].trim() }}",
              "type": "string"
            },
            {
              "id": "f6770479-ac1f-4623-89b0-e56b88bc3968",
              "name": "FormId",
              "value": "={{ $json.body.formId }}",
              "type": "string"
            },
            {
              "id": "7c396a7c-5177-4e50-b985-d3ca774ae059",
              "name": "StudentId_c·∫≠p_nh·∫≠t",
              "value": "={{ $json.body['M√£ sinh vi√™n (n·∫øu c·∫≠p nh·∫≠t th√¥ng tin)'].toUpperCase() }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1824,
        80
      ],
      "id": "8a86f9c7-f604-4154-9a61-d61db8b6c4c6",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Edit Fields2').item.json['GoogleSheet_L·ªõp'] }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Trang t√≠nh1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1cRUJYaEtYDQeNfB6fqGUHAn7WEQhqezjsDYfQ0fg5K4/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "StudentID": "={{ $('Edit Fields').item.json['M√£ h·ªçc sinh'] }}",
            "H·ªç v√† T√™n": "={{ $('Edit Fields').item.json['H·ªç v√† t√™n'] }}",
            "T√™n tr∆∞·ªùng h·ªçc": "={{ $('Edit Fields').item.json['T√™n tr∆∞·ªùng'] }}",
            "Gi·ªõi t√≠nh": "={{ $('Edit Fields').item.json['Gi·ªõi t√≠nh'] }}",
            "L·ªõp h·ªçc": "={{ $('Edit Fields').item.json['L·ªõp h·ªçc'] }}",
            "Ng√†y th√°ng nƒÉm sinh": "={{ $('Edit Fields').item.json['Ng√†y th√°ng nƒÉm sinh'] }}",
            "Email": "={{ $('Edit Fields').item.json.Gmail }}",
            "S·ªë ƒëi·ªán tho·∫°i": "={{ $('Edit Fields').item.json['S·ªë ƒëi·ªán tho·∫°i'] }}",
            "FolderID": "={{ $json['FOLDER_H·ªçc_sinh'] }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "StudentID",
              "displayName": "StudentID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "H·ªç v√† T√™n",
              "displayName": "H·ªç v√† T√™n",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Gi·ªõi t√≠nh",
              "displayName": "Gi·ªõi t√≠nh",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Ng√†y th√°ng nƒÉm sinh",
              "displayName": "Ng√†y th√°ng nƒÉm sinh",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "L·ªõp h·ªçc",
              "displayName": "L·ªõp h·ªçc",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "T√™n tr∆∞·ªùng h·ªçc",
              "displayName": "T√™n tr∆∞·ªùng h·ªçc",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "S·ªë ƒëi·ªán tho·∫°i",
              "displayName": "S·ªë ƒëi·ªán tho·∫°i",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "FolderID",
              "displayName": "FolderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        4896,
        0
      ],
      "id": "a910ec02-1e67-4b0c-b738-1144f44f8777",
      "name": "Append row in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $('Edit Fields').first().json.Gmail }}",
        "subject": "=C·∫≠p nh·∫≠t th√¥ng tin th√†nh c√¥ng cho h·ªçc sinh {{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }} - {{ $('Edit Fields').first().json['M√£ h·ªçc sinh'] }}",
        "message": "=<div style=\"font-family: Arial, sans-serif; color: #333; line-height: 1.6; max-width: 600px; margin: 0 auto; border: 1px solid #ddd;\">\n  \n  <span style=\"display:none; font-size:1px; color:#ffffff; line-height:1px; max-height:0px; max-width:0px; opacity:0; overflow:hidden;\">\n    X√°c nh·∫≠n ƒëƒÉng k√Ω th√†nh c√¥ng! Ch√†o m·ª´ng em ƒë·∫øn v·ªõi h·ªá th·ªëng.\n  </span>\n\n  <div style=\"background-color: #0056d6; color: white; padding: 20px; text-align: center;\">\n    <h2 style=\"margin: 0;\">H·ªá th·ªëng Tr·ª£ l√Ω h·ªçc t·∫≠p ·∫£o</h2>\n  </div>\n\n  <div style=\"padding: 20px;\">\n    <p>Ch√†o em <strong>{{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }}</strong>,</p>\n    <p>C·∫£m ∆°n em ƒë√£ ƒëƒÉng k√Ω th√¥ng tin v·ªõi H·ªá th·ªëng Tr·ª£ l√Ω h·ªçc t·∫≠p ·∫£o. D∆∞·ªõi ƒë√¢y l√† th√¥ng tin h·ªá th·ªëng ƒë√£ ghi nh·∫≠n. Em vui l√≤ng ki·ªÉm tra l·∫°i ƒë·ªÉ ƒë·∫£m b·∫£o m·ªçi th·ª© ƒë·ªÅu ch√≠nh x√°c nh√©.</p>\n    \n    <h3 style=\"color:#0056d6; border-bottom: 2px solid #0056d6; padding-bottom: 5px;\">Th√¥ng tin c·ªßa em</h3>\n    <table style=\"width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 15px;\">\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; width: 150px; background-color: #f9f9f9;\"><strong>H·ªç v√† t√™n:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json['H·ªç v√† t√™n'] }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>M√£ h·ªçc sinh:</strong></td>\n        <td style=\"padding: 10px;\"><strong>{{ $('Edit Fields').first().json['M√£ h·ªçc sinh'] }}</strong></td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>Tr∆∞·ªùng:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json['T√™n tr∆∞·ªùng'] }}</td>\n      </tr>\n       <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>L·ªõp:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json['L·ªõp h·ªçc'] }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>Ng√†y sinh:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json['Ng√†y th√°ng nƒÉm sinh'] }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>Gi·ªõi t√≠nh:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json['Gi·ªõi t√≠nh'] }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>Email:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json.Gmail }}</td>\n      </tr>\n      <tr>\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>S·ªë ƒëi·ªán tho·∫°i:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').first().json['S·ªë ƒëi·ªán tho·∫°i'] }}</td>\n      </tr>\n    </table>\n    \n    <div style=\"margin-top: 25px; padding: 15px; text-align: center; background-color: #f0f5ff; border-radius: 4px; border-left: 4px solid #0056d6;\">\n      <p style=\"margin: 0; font-size: 16px;\">üí° Em h√£y l∆∞u l·∫°i <strong>M√£ h·ªçc sinh</strong> c·ªßa m√¨nh ƒë·ªÉ s·ª≠ d·ª•ng cho c√°c ho·∫°t ƒë·ªông sau n√†y nh√©!</p>\n    </div>\n\n    <div style=\"margin-top: 30px;\">\n        <h3 style=\"color:#0056d6; border-bottom: 2px solid #0056d6; padding-bottom: 5px;\">Kh√¥ng gian h·ªçc t·∫≠p c√° nh√¢n</h3>\n        <p>H·ªá th·ªëng ƒë√£ t·∫°o m·ªôt th∆∞ m·ª•c ri√™ng tr√™n Google Drive ƒë·ªÉ l∆∞u tr·ªØ t·∫•t c·∫£ t√†i li·ªáu, b√†i gi·∫£ng v√† b√†i t·∫≠p c·ªßa em. Em h√£y truy c·∫≠p ngay ƒë·ªÉ b·∫Øt ƒë·∫ßu nh√©!</p>\n        <div style=\"text-align: center; margin: 20px 0;\">\n            <a href=\"https://drive.google.com/drive/folders/{{ $('Edit Fields3').first().json.FOLDER_H·ªçc_sinh }}\" target=\"_blank\" style=\"display: inline-block; background-color: #0056d6; color: #ffffff; padding: 12px 25px; text-decoration: none; border-radius: 5px; font-weight: bold;\">\n                TRUY C·∫¨P TH∆Ø M·ª§C H·ªåC T·∫¨P\n            </a>\n        </div>\n        <p style=\"text-align: center; font-size: 14px; color: #666; margin-top: 10px;\">\n            <strong>L∆∞u √Ω:</strong> Em h√£y t√¨m th∆∞ m·ª•c n√†y trong m·ª•c <strong>\"ƒê∆∞·ª£c chia s·∫ª v·ªõi t√¥i\" (Shared with me)</strong> tr√™n Google Drive c·ªßa m√¨nh.\n        </p>\n    </div>\n\n    <div style=\"margin-top: 25px; padding: 15px; text-align: center; background-color: #fffbe6; border: 1px solid #fdec9a; border-radius: 5px;\">\n        <p style=\"margin-top: 0;\">N·∫øu ph√°t hi·ªán c√≥ th√¥ng tin ch∆∞a ch√≠nh x√°c, em vui l√≤ng nh·∫•n v√†o n√∫t b√™n d∆∞·ªõi ƒë·ªÉ ƒëi·ªÅn l·∫°i Form.</p>\n        <a href=\"https://docs.google.com/forms/d/{{ $('Edit Fields').first().json.FormId }}/viewform\" target=\"_blank\" style=\"display: inline-block; background-color: #ffc107; color: #212529; padding: 10px 20px; text-decoration: none; border-radius: 5px; font-weight: bold; margin-top: 5px;\">\n          B√ÅO C√ÅO SAI S√ìT\n        </a>\n    </div>\n    \n    <br>\n    <p>Ch√∫c em c√≥ nh·ªØng tr·∫£i nghi·ªám h·ªçc t·∫≠p th·∫≠t hi·ªáu qu·∫£!</p>\n    <p><strong>H·ªá th·ªëng Tr·ª£ l√Ω h·ªçc t·∫≠p ·∫£o</strong></p>\n  </div>\n\n  <div style=\"background-color: #f4f4f4; padding: 10px; text-align: center; font-size: 12px; color: #666;\">\n    <p>ƒê√¢y l√† email ƒë∆∞·ª£c g·ª≠i t·ª± ƒë·ªông, em kh√¥ng c·∫ßn tr·∫£ l·ªùi l·∫°i email n√†y.</p>\n  </div>\n</div>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        10896,
        64
      ],
      "id": "3eba6e6f-2a52-4f30-bde9-f36d55145c55",
      "name": "Send a message",
      "webhookId": "9ae1a4e7-1a7d-4591-92f8-f044c489bdaa",
      "credentials": {
        "gmailOAuth2": {
          "id": "kngvm6WXlbqXMFKV",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0ab474ef-89bf-4ecb-9170-93861a9cc593",
              "leftValue": "={{ $json.id }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notExists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -1008,
        80
      ],
      "id": "ddc6f5e7-3075-48aa-9e62-a5225e9a844f",
      "name": "If"
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "={{ (()=> {   const now = DateTime.now();   const startYear = now.month >= 8 ? now.year : now.year - 1;   const endYear = startYear + 1;   return startYear + \" - \" + endYear; })() }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('Search files and folders6').item.json.id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -816,
        0
      ],
      "id": "3a029143-8d1f-45db-8d4a-5ac0315427c7",
      "name": "Create folder",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "Admin_Registry",
        "filter": {
          "whatToSearch": "folders"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -1616,
        80
      ],
      "id": "df76e9fb-1368-461a-8cb8-b8813c5f28f8",
      "name": "Search files and folders3",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "FOLDER_Students",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $json.id }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -1408,
        80
      ],
      "id": "f425ef3e-13d3-4a7a-a2bd-d9186ef131a5",
      "name": "Search files and folders6",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "={{ (()=> {   const now = DateTime.now();   const startYear = now.month >= 8 ? now.year : now.year - 1;   const endYear = startYear + 1;   return startYear + \" - \" + endYear; })() }}",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $json.id }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -1200,
        80
      ],
      "id": "8c225b4f-024d-46a0-9d65-065176091712",
      "name": "Search files and folders7",
      "alwaysOutputData": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "={{ $json.folderName }}",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Folder_nƒÉm').item.json['Folder_NƒÉm'] }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        752,
        96
      ],
      "id": "3b6d7810-5790-4081-bea4-871c09f0a6a3",
      "name": "Search files and folders",
      "alwaysOutputData": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const classString = $('Edit Fields').first().json['L·ªõp h·ªçc'];\nif (!classString) {\n  return [];\n}\n\nconst classes = classString.split(',').map(c => c.trim());\nconst gradeNumbers = classes.map(c => (c.match(/^\\d+/) || [])[0]).filter(Boolean);\nconst uniqueGradeNumbers = [...new Set(gradeNumbers)];\n\n// Tr·∫£ v·ªÅ m·ªôt m·∫£ng c√°c ƒë·ªëi t∆∞·ª£ng, m·ªói ƒë·ªëi t∆∞·ª£ng c√≥ m·ªôt t√™n th∆∞ m·ª•c\nconst folderItems = uniqueGradeNumbers.map(grade => ({\n  json: {\n    folderName: `Kh·ªëi ${grade}`\n  }\n}));\n\nreturn folderItems;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        528,
        96
      ],
      "id": "b23815cf-37a0-46f0-bdfa-9598f45f3542",
      "name": "Code1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0ab474ef-89bf-4ecb-9170-93861a9cc593",
              "leftValue": "={{ $json.id }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notExists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        944,
        96
      ],
      "id": "2b2d6947-05b2-4bbe-bdd1-d56faef604ee",
      "name": "If3"
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "={{ $('Code1').item.json.folderName }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('Folder_nƒÉm').item.json['Folder_NƒÉm'] }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1136,
        16
      ],
      "id": "119dfe2a-1289-4066-9561-aba0349b64eb",
      "name": "Create folder1",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "4a855fc3-2e6a-4f16-93a1-38fcd4f9f4e8",
              "name": "Folder_NƒÉm",
              "value": "={{ $json.id || $('Search files and folders7').item.json.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -624,
        96
      ],
      "id": "add4b21a-760c-4bd1-b4e4-94b275e03679",
      "name": "Folder_nƒÉm"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "4a855fc3-2e6a-4f16-93a1-38fcd4f9f4e8",
              "name": "Folder_Kh·ªëi",
              "value": "={{ $json.id || $('Search files and folders').item.json.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1312,
        112
      ],
      "id": "e891c897-a312-4275-8699-bd0d6e925d96",
      "name": "Folder_Kh·ªëi"
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "={{ $('Edit Fields').item.json['L·ªõp h·ªçc'] }}",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $json['Folder_Kh·ªëi'] }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1536,
        112
      ],
      "id": "a5c3523c-6398-4f2d-82a2-8755f2b76c07",
      "name": "Search files and folders2",
      "alwaysOutputData": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0ab474ef-89bf-4ecb-9170-93861a9cc593",
              "leftValue": "={{ $json.id }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notExists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1744,
        112
      ],
      "id": "6bca5f00-1df0-442a-a2ba-350fa43d1839",
      "name": "If4"
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "={{ $('Edit Fields').item.json['L·ªõp h·ªçc'] }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('Folder_Kh·ªëi').item.json['Folder_Kh·ªëi'] }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1936,
        16
      ],
      "id": "ba7e1da0-6b93-47bf-9f70-1837eb12662e",
      "name": "Create folder2",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "4a855fc3-2e6a-4f16-93a1-38fcd4f9f4e8",
              "name": "Folder_L·ªõp",
              "value": "={{ $json.id || $('Search files and folders2').item.json.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2128,
        128
      ],
      "id": "3c5444ff-b83f-4e04-9859-69a8fd60ff30",
      "name": "Folder_L·ªõp"
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "=Danh s√°ch h·ªçc sinh l·ªõp  {{ $('Edit Fields').item.json['L·ªõp h·ªçc'] }}",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Folder_L·ªõp').item.json['Folder_L·ªõp'] }}",
            "mode": "id"
          },
          "whatToSearch": "files",
          "fileTypes": [
            "application/vnd.google-apps.spreadsheet"
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        2352,
        128
      ],
      "id": "3f0d3535-5a8b-4c95-8fe5-89a20e46f7f0",
      "name": "Search files and folders4",
      "alwaysOutputData": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "200df760-d69e-4cfd-8824-44c4e8154f75",
              "leftValue": "={{ $json.id }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notExists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2560,
        128
      ],
      "id": "b10cc4e7-a8ac-48a9-8c7b-0f5939466b43",
      "name": "If5"
    },
    {
      "parameters": {
        "resource": "spreadsheet",
        "title": "=Danh s√°ch h·ªçc sinh l·ªõp {{ $('Edit Fields').item.json['L·ªõp h·ªçc'] }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2784,
        16
      ],
      "id": "71d348ca-a710-4cd8-bc3d-7feb56ab3da8",
      "name": "Create spreadsheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "be0f1a24-d22f-4ac6-b6c4-7ca6f39e6d00",
              "name": "StudentID",
              "value": "",
              "type": "string"
            },
            {
              "id": "3ddabecd-353b-4980-833b-5d0a58b6c076",
              "name": "H·ªç v√† T√™n",
              "value": "",
              "type": "string"
            },
            {
              "id": "e8cf7684-67ea-43f2-a411-d7422dec0249",
              "name": "Gi·ªõi t√≠nh",
              "value": "",
              "type": "string"
            },
            {
              "id": "ef7b2e98-fbc7-4c28-9fb7-ae2a64e83a79",
              "name": "Ng√†y th√°ng nƒÉm sinh",
              "value": "",
              "type": "string"
            },
            {
              "id": "3fd41131-300e-4b37-acc7-44f93a832bf0",
              "name": "L·ªõp h·ªçc",
              "value": "",
              "type": "string"
            },
            {
              "id": "82f34bc6-7de3-4682-8920-149593b37d5a",
              "name": "T√™n tr∆∞·ªùng h·ªçc",
              "value": "",
              "type": "string"
            },
            {
              "id": "610de59c-1688-4f39-a35a-2f8bd1f1f28e",
              "name": "Email",
              "value": "",
              "type": "string"
            },
            {
              "id": "4b6db733-1231-4583-8ea5-44289474f3b5",
              "name": "S·ªë ƒëi·ªán tho·∫°i",
              "value": {},
              "type": "string"
            },
            {
              "id": "c6a8deae-1fe0-4743-bf93-cd72424110d3",
              "name": "FolderID",
              "value": "",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2992,
        16
      ],
      "id": "fc68cb8b-a69c-4f05-b32f-2dd8046f9fc0",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Create spreadsheet').item.json.spreadsheetId }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Trang t√≠nh1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1cRUJYaEtYDQeNfB6fqGUHAn7WEQhqezjsDYfQ0fg5K4/edit#gid=0"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {},
          "matchingColumns": [],
          "schema": [
            {
              "id": "StudentID",
              "displayName": "StudentID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "H·ªç v√† T√™n",
              "displayName": "H·ªç v√† T√™n",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Gi·ªõi t√≠nh",
              "displayName": "Gi·ªõi t√≠nh",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Ng√†y th√°ng nƒÉm sinh",
              "displayName": "Ng√†y th√°ng nƒÉm sinh",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "L·ªõp h·ªçc",
              "displayName": "L·ªõp h·ªçc",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "T√™n tr∆∞·ªùng h·ªçc",
              "displayName": "T√™n tr∆∞·ªùng h·ªçc",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "S·ªë ƒëi·ªán tho·∫°i",
              "displayName": "S·ªë ƒëi·ªán tho·∫°i",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3200,
        16
      ],
      "id": "a831ac02-9d71-4026-95a4-2b899797ddd1",
      "name": "Append row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "operation": "move",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Create spreadsheet').item.json.spreadsheetId }}",
          "mode": "id"
        },
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('Folder_L·ªõp').item.json['Folder_L·ªõp'] }}",
          "mode": "id"
        }
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        3408,
        16
      ],
      "id": "0fdd3bcc-93bb-4a72-ba1e-dacc3b81530b",
      "name": "Move file1",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "96376d60-33a6-4b05-a5df-69205cd09c0c",
              "name": "GoogleSheet_L·ªõp",
              "value": "={{ $json.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3632,
        144
      ],
      "id": "e3b62d9c-a666-4548-84c7-246ad7d221a6",
      "name": "Edit Fields2"
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "={{ $('Edit Fields').item.json['M√£ h·ªçc sinh'] }} - {{ $('Edit Fields').item.json['H·ªç v√† t√™n'] }}",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Folder_L·ªõp').item.json.Folder_L·ªõp }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        4096,
        -16
      ],
      "id": "f4dee533-9ac0-4333-b7ac-e348c835db6f",
      "name": "Search files and folders1",
      "alwaysOutputData": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "68e56e1f-b509-483d-8c58-c7c92e5c3fe8",
              "leftValue": "={{ $json.id }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notExists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        4304,
        -16
      ],
      "id": "59de0dec-1bec-41d5-baf7-537165ab6c09",
      "name": "If6"
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "={{ $('Edit Fields').item.json['M√£ h·ªçc sinh'] }} - {{ $('Edit Fields').item.json['H·ªç v√† t√™n'] }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "={{ $('Folder_L·ªõp').item.json['Folder_L·ªõp'] }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        4496,
        -96
      ],
      "id": "ac4c4133-095d-484d-83f8-223765cbcc62",
      "name": "Create folder3",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "d4ec3c1f-c372-46ae-a143-4f0ef55f1d4d",
              "name": "FOLDER_H·ªçc_sinh",
              "value": "={{ $json.id || $('Search files and folders1').item.json.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        4672,
        0
      ],
      "id": "4e1b4533-188d-411b-8b13-9215ea6c5123",
      "name": "Edit Fields3"
    },
    {
      "parameters": {
        "resource": "folder",
        "operation": "share",
        "folderNoRootId": {
          "__rl": true,
          "value": "={{ $('Edit Fields3').first().json['FOLDER_H·ªçc_sinh'] }}",
          "mode": "id"
        },
        "permissionsUi": {
          "permissionsValues": {
            "role": "reader",
            "type": "user",
            "emailAddress": "={{ $('Edit Fields').first().json.Gmail }}"
          }
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        10704,
        64
      ],
      "id": "4ccae491-c54f-4f94-a2e6-279e2f6adb82",
      "name": "Share folder",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "ebeb5cc1-fbee-4e20-ae1b-d6262bafdcdf",
              "leftValue": "={{ $('Edit Fields').item.json['StudentId_c·∫≠p_nh·∫≠t'] }}",
              "rightValue": 0,
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3840,
        144
      ],
      "id": "3c13d7fe-2ceb-45eb-8dff-e9d86311e6bb",
      "name": "If7"
    },
    {
      "parameters": {
        "sendTo": "={{ $('Edit Fields').first().json.Gmail }}",
        "subject": "X√°c nh·∫≠n th√¥ng tin ƒë√£ t·ªìn t·∫°i",
        "message": "=<!DOCTYPE html>\n<html lang=\"vi\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>X√°c nh·∫≠n Th√¥ng tin H·ªçc sinh</title>\n</head>\n<body style=\"margin: 0; padding: 0; background-color: #f4f4f4; font-family: Arial, sans-serif;\">\n    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"background-color: #f4f4f4;\">\n        <tr>\n            <td align=\"center\">\n                <div style=\"max-width: 600px; margin: 20px auto; background-color: #ffffff; padding: 30px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);\">\n                    <h1 style=\"color: #333333; text-align: center; border-bottom: 2px solid #eeeeee; padding-bottom: 20px; margin-top: 0;\">\n                        X√°c nh·∫≠n Th√¥ng tin H·ªçc sinh\n                    </h1>\n                    <p style=\"font-size: 16px; color: #555555; line-height: 1.6;\">\n                        Ch√†o em <strong>{{ $('Edit Fields').first().json[\"H·ªç v√† t√™n\"] }}</strong>,\n                    </p>\n                    <p style=\"font-size: 16px; color: #555555; line-height: 1.6;\">\n                        C·∫£m ∆°n em ƒë√£ ƒëƒÉng k√Ω. H·ªá th·ªëng c·ªßa ch√∫ng t√¥i t√¨m th·∫•y m·ªôt h·ªì s∆° ƒë√£ t·ªìn t·∫°i v·ªõi th√¥ng tin t∆∞∆°ng t·ª±. Em vui l√≤ng xem v√† x√°c nh·∫≠n ƒë√¢y c√≥ ph·∫£i l√† th√¥ng tin c·ªßa m√¨nh kh√¥ng nh√©:\n                    </p>\n                    \n                    <div style=\"background-color: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 8px; margin: 25px 0; padding: 20px;\">\n                        <h3 style=\"color: #4285f4; margin-top: 0; text-align: center; margin-bottom: 20px;\">Th√¥ng tin ch√∫ng t√¥i t√¨m th·∫•y</h3>\n                        <p style=\"font-size: 16px; color: #333; line-height: 1.8; margin: 10px 0;\">\n                            <strong>H·ªç v√† t√™n:</strong> {{ $('Code in JavaScript9').first().json.fullName }}\n                        </p>\n                        <p style=\"font-size: 16px; color: #333; line-height: 1.8; margin: 10px 0;\">\n                            <strong>Email:</strong> {{ $('Code in JavaScript9').first().json.email }}\n                        </p>\n                        <p style=\"font-size: 16px; color: #333; line-height: 1.8; margin: 10px 0;\">\n                            <strong>M√£ h·ªçc sinh:</strong>\n                            <strong style=\"color: #d9534f;\">{{ $('Code in JavaScript9').first().json.StudentID }}</strong>\n                        </p>\n                    </div>\n\n                    <p style=\"font-size: 16px; color: #555555; line-height: 1.6;\">\n                        - N·∫øu th√¥ng tin tr√™n <strong>ƒë√∫ng l√† c·ªßa em</strong>, em c√≥ th·ªÉ b·ªè qua email n√†y v√† h√£y s·ª≠ d·ª•ng <strong>M√£ h·ªçc sinh</strong> ƒë√£ ƒë∆∞·ª£c cung c·∫•p cho c√°c ho·∫°t ƒë·ªông sau n√†y.\n                    </p>\n                    <p style=\"font-size: 16px; color: #555555; line-height: 1.6;\">\n                        - N·∫øu ƒë√¢y <strong>kh√¥ng ph·∫£i l√† th√¥ng tin c·ªßa em</strong> ho·∫∑c c√≥ sai s√≥t, vui l√≤ng li√™n h·ªá gi√°o vi√™n ho·∫∑c b·ªô ph·∫≠n h·ªó tr·ª£ ƒë·ªÉ ƒë∆∞·ª£c x·ª≠ l√Ω.\n                    </p>\n                    \n                    <p style=\"font-size: 14px; color: #888888; line-height: 1.6; margin-top: 30px; text-align: center; border-top: 1px solid #eeeeee; padding-top: 20px;\">\n                        ƒê√¢y l√† email t·ª± ƒë·ªông, vui l√≤ng kh√¥ng tr·∫£ l·ªùi tr·ª±c ti·∫øp.\n                    </p>\n                </div>\n            </td>\n        </tr>\n    </table>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        720,
        -304
      ],
      "id": "0d537f3f-efb0-4114-af28-74ae80f6571d",
      "name": "Send a message3",
      "webhookId": "e57cf627-15d0-4b3f-b887-1f0d6f351e86",
      "executeOnce": true,
      "credentials": {
        "gmailOAuth2": {
          "id": "kngvm6WXlbqXMFKV",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $('Edit Fields').item.json.Gmail }}",
        "subject": "Th√¥ng b√°o: D·ªØ li·ªáu M√£ H·ªçc Sinh kh√¥ng tr√πng kh·ªõp",
        "message": "=<!DOCTYPE html>\n<html lang=\"vi\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Th√¥ng b√°o L·ªói D·ªØ li·ªáu</title>\n</head>\n<body style=\"font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 20px;\">\n    <div style=\"max-width: 600px; margin: auto; background-color: #ffffff; padding: 30px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);\">\n        <h1 style=\"color: #d9534f; text-align: center; border-bottom: 2px solid #eeeeee; padding-bottom: 20px;\">\n            ‚ö†Ô∏è D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá\n        </h1>\n        <p style=\"font-size: 16px; color: #555555; line-height: 1.6;\">\n            Ch√†o em <strong>{{ $('Edit Fields').item.json[\"H·ªç v√† t√™n\"] }}</strong>,\n        </p>\n        <p style=\"font-size: 16px; color: #555555; line-height: 1.6;\">\n            H·ªá th·ªëng nh·∫≠n ƒë∆∞·ª£c y√™u c·∫ßu c·∫≠p nh·∫≠t th√¥ng tin c·ªßa em. Tuy nhi√™n, ch√∫ng t√¥i ph√°t hi·ªán c√≥ s·ª± kh√¥ng tr√πng kh·ªõp gi·ªØa th√¥ng tin em cung c·∫•p.\n        </p>\n        <div style=\"background-color: #fcf8e3; border-left: 5px solid #f0ad4e; margin: 20px 0; padding: 15px 20px;\">\n            <p style=\"margin: 0; font-size: 16px; color: #8a6d3b;\">\n                M√£ h·ªçc sinh <strong>{{ $('Get row(s) in sheet1').item.json.StudentID }}</strong> m√† em cung c·∫•p kh√¥ng kh·ªõp v·ªõi th√¥ng tin c√° nh√¢n c·ªßa em trong h·ªá th·ªëng c·ªßa ch√∫ng t√¥i.\n            </p>\n        </div>\n        <p style=\"font-size: 16px; color: #555555; line-height: 1.6;\">\n            Vui l√≤ng th·ª±c hi·ªán m·ªôt trong c√°c thao t√°c sau:\n        </p>\n        <ul style=\"font-size: 16px; color: #555555; line-height: 1.8; padding-left: 20px;\">\n            <li><strong>Ki·ªÉm tra l·∫°i</strong> v√† nh·∫≠p ch√≠nh x√°c M√£ h·ªçc sinh ƒë√£ ƒë∆∞·ª£c c·∫•p cho em.</li>\n            <li>N·∫øu em l√† <strong>h·ªçc sinh m·ªõi</strong>, vui l√≤ng <strong>b·ªè tr·ªëng</strong> √¥ M√£ h·ªçc sinh khi ƒëi·ªÅn form ƒë·ªÉ ƒë∆∞·ª£c h·ªá th·ªëng c·∫•p m√£ m·ªõi.</li>\n        </ul>\n        <div style=\"text-align: center; margin-top: 30px;\">\n            <a href=\"https://docs.google.com/forms/d/{{ $('Edit Fields').item.json.googleFormId }}/viewform\" target=\"_blank\" style=\"background-color: #4285f4; color: #ffffff; padding: 15px 30px; text-decoration: none; border-radius: 5px; font-size: 16px; font-weight: bold;\">\n                Th·ª≠ l·∫°i\n            </a>\n        </div>\n        <p style=\"font-size: 14px; color: #888888; text-align: center; margin-top: 30px; border-top: 1px solid #eeeeee; padding-top: 20px;\">\n            N·∫øu em tin r·∫±ng ƒë√¢y l√† m·ªôt s·ª± nh·∫ßm l·∫´n, vui l√≤ng li√™n h·ªá v·ªõi gi√°o vi√™n ho·∫∑c b·ªô ph·∫≠n h·ªó tr·ª£.\n        </p>\n    </div>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        336,
        -416
      ],
      "id": "e8960368-c8fc-479c-aefd-1bea7167eef3",
      "name": "Send a message4",
      "webhookId": "13b7c630-d5df-4102-b58e-dcb031825a6f",
      "credentials": {
        "gmailOAuth2": {
          "id": "kngvm6WXlbqXMFKV",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $('Edit Fields').item.json.Gmail }}",
        "subject": "=C·∫≠p nh·∫≠t th√¥ng tin th√†nh c√¥ng cho h·ªçc sinh {{ $('Edit Fields').item.json['H·ªç v√† t√™n'] }} - {{ $('Edit Fields').item.json['M√£ h·ªçc sinh'] }}",
        "message": "=<div style=\"font-family: Arial, sans-serif; color: #333; line-height: 1.6; max-width: 600px; margin: 0 auto; border: 1px solid #ddd;\">\n  \n  <span style=\"display:none; font-size:1px; color:#ffffff; line-height:1px; max-height:0px; max-width:0px; opacity:0; overflow:hidden;\">\n    X√°c nh·∫≠n ƒëƒÉng k√Ω th√†nh c√¥ng! Ch√†o m·ª´ng em ƒë·∫øn v·ªõi h·ªá th·ªëng.\n  </span>\n\n  <div style=\"background-color: #0056d6; color: white; padding: 20px; text-align: center;\">\n    <h2 style=\"margin: 0;\">H·ªá th·ªëng Tr·ª£ l√Ω h·ªçc t·∫≠p ·∫£o</h2>\n  </div>\n\n  <div style=\"padding: 20px;\">\n    <p>Ch√†o em <strong>{{ $('Edit Fields').item.json['H·ªç v√† t√™n'] }}</strong>,</p>\n    <p>C·∫£m ∆°n em ƒë√£ ƒëƒÉng k√Ω th√¥ng tin v·ªõi H·ªá th·ªëng Tr·ª£ l√Ω h·ªçc t·∫≠p ·∫£o. D∆∞·ªõi ƒë√¢y l√† th√¥ng tin h·ªá th·ªëng ƒë√£ ghi nh·∫≠n. Em vui l√≤ng ki·ªÉm tra l·∫°i ƒë·ªÉ ƒë·∫£m b·∫£o m·ªçi th·ª© ƒë·ªÅu ch√≠nh x√°c nh√©.</p>\n    \n    <h3 style=\"color:#0056d6; border-bottom: 2px solid #0056d6; padding-bottom: 5px;\">Th√¥ng tin c·ªßa em</h3>\n    <table style=\"width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 15px;\">\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; width: 150px; background-color: #f9f9f9;\"><strong>H·ªç v√† t√™n:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').item.json['H·ªç v√† t√™n'] }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>M√£ h·ªçc sinh:</strong></td>\n        <td style=\"padding: 10px;\"><strong>{{ $('Edit Fields').item.json['M√£ h·ªçc sinh'] }}</strong></td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>Tr∆∞·ªùng:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').item.json['T√™n tr∆∞·ªùng'] }}</td>\n      </tr>\n       <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>L·ªõp:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').item.json['L·ªõp h·ªçc'] }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>Ng√†y sinh:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').item.json['Ng√†y th√°ng nƒÉm sinh'] }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>Gi·ªõi t√≠nh:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').item.json['Gi·ªõi t√≠nh'] }}</td>\n      </tr>\n      <tr style=\"border-bottom: 1px solid #eee;\">\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>Email:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').item.json.Gmail }}</td>\n      </tr>\n      <tr>\n        <td style=\"padding: 10px; background-color: #f9f9f9;\"><strong>S·ªë ƒëi·ªán tho·∫°i:</strong></td>\n        <td style=\"padding: 10px;\">{{ $('Edit Fields').item.json['S·ªë ƒëi·ªán tho·∫°i'] }}</td>\n      </tr>\n    </table>\n    \n    <div style=\"margin-top: 25px; padding: 15px; text-align: center; background-color: #f0f5ff; border-radius: 4px; border-left: 4px solid #0056d6;\">\n      <p style=\"margin: 0; font-size: 16px;\">üí° Em h√£y l∆∞u l·∫°i <strong>M√£ h·ªçc sinh</strong> c·ªßa m√¨nh ƒë·ªÉ s·ª≠ d·ª•ng cho c√°c ho·∫°t ƒë·ªông sau n√†y nh√©!</p>\n    </div>\n\n    <div style=\"margin-top: 30px;\">\n        <h3 style=\"color:#0056d6; border-bottom: 2px solid #0056d6; padding-bottom: 5px;\">Kh√¥ng gian h·ªçc t·∫≠p c√° nh√¢n</h3>\n        <p>H·ªá th·ªëng ƒë√£ t·∫°o m·ªôt th∆∞ m·ª•c ri√™ng tr√™n Google Drive ƒë·ªÉ l∆∞u tr·ªØ t·∫•t c·∫£ t√†i li·ªáu, b√†i gi·∫£ng v√† b√†i t·∫≠p c·ªßa em. Em h√£y truy c·∫≠p ngay ƒë·ªÉ b·∫Øt ƒë·∫ßu nh√©!</p>\n        <div style=\"text-align: center; margin: 20px 0;\">\n            <a href=\"https://drive.google.com/drive/folders/{{ $('Edit Fields6').item.json.FOLDER_H·ªçc_sinh }}\" target=\"_blank\" style=\"display: inline-block; background-color: #0056d6; color: #ffffff; padding: 12px 25px; text-decoration: none; border-radius: 5px; font-weight: bold;\">\n                TRUY C·∫¨P TH∆Ø M·ª§C H·ªåC T·∫¨P\n            </a>\n        </div>\n        <p style=\"text-align: center; font-size: 14px; color: #666; margin-top: 10px;\">\n            <strong>L∆∞u √Ω:</strong> Em h√£y t√¨m th∆∞ m·ª•c n√†y trong m·ª•c <strong>\"ƒê∆∞·ª£c chia s·∫ª v·ªõi t√¥i\" (Shared with me)</strong> tr√™n Google Drive c·ªßa m√¨nh.\n        </p>\n    </div>\n\n    <div style=\"margin-top: 25px; padding: 15px; text-align: center; background-color: #fffbe6; border: 1px solid #fdec9a; border-radius: 5px;\">\n        <p style=\"margin-top: 0;\">N·∫øu ph√°t hi·ªán c√≥ th√¥ng tin ch∆∞a ch√≠nh x√°c, em vui l√≤ng nh·∫•n v√†o n√∫t b√™n d∆∞·ªõi ƒë·ªÉ ƒëi·ªÅn l·∫°i Form.</p>\n        <a href=\"https://docs.google.com/forms/d/{{ $('Edit Fields').item.json.FormId }}/viewform\" target=\"_blank\" style=\"display: inline-block; background-color: #ffc107; color: #212529; padding: 10px 20px; text-decoration: none; border-radius: 5px; font-weight: bold; margin-top: 5px;\">\n          B√ÅO C√ÅO SAI S√ìT\n        </a>\n    </div>\n    \n    <br>\n    <p>Ch√∫c em c√≥ nh·ªØng tr·∫£i nghi·ªám h·ªçc t·∫≠p th·∫≠t hi·ªáu qu·∫£!</p>\n    <p><strong>H·ªá th·ªëng Tr·ª£ l√Ω h·ªçc t·∫≠p ·∫£o</strong></p>\n  </div>\n\n  <div style=\"background-color: #f4f4f4; padding: 10px; text-align: center; font-size: 12px; color: #666;\">\n    <p>ƒê√¢y l√† email ƒë∆∞·ª£c g·ª≠i t·ª± ƒë·ªông, em kh√¥ng c·∫ßn tr·∫£ l·ªùi l·∫°i email n√†y.</p>\n  </div>\n</div>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        4496,
        272
      ],
      "id": "cb06f77e-6054-44ff-a5ef-14a3429525c5",
      "name": "Send a message1",
      "webhookId": "9ae1a4e7-1a7d-4591-92f8-f044c489bdaa",
      "credentials": {
        "gmailOAuth2": {
          "id": "kngvm6WXlbqXMFKV",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "[ADMIN] Master Control Sheet",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Search files and folders3').item.json.id }}",
            "mode": "id"
          },
          "whatToSearch": "files",
          "fileTypes": [
            "application/vnd.google-apps.spreadsheet"
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        5104,
        0
      ],
      "id": "cdea7942-247d-4200-bf79-7defeafbd864",
      "name": "Search files and folders9",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "={{ $json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "SchoolYears",
          "mode": "name"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        5312,
        0
      ],
      "id": "05f09e59-578f-4075-8643-01effb0c1192",
      "name": "Get row(s) in sheet3",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "cec262d7-1937-47fa-be04-3e9780b4468a",
              "leftValue": "={{ $json.exists }}",
              "rightValue": "true",
              "operator": {
                "type": "boolean",
                "operation": "false",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        5728,
        0
      ],
      "id": "9de35bcc-1d0b-446b-9060-1f1ca85feabe",
      "name": "If11"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "SchoolYears",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "YearID": "={{ $json.YearID }}",
            "YearName": "={{ $json.YearName }}",
            "YearFolderID": "={{ $json.YearFolderID }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "YearID",
              "displayName": "YearID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "YearName",
              "displayName": "YearName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "YearFolderID",
              "displayName": "YearFolderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ParentYearID",
              "displayName": "ParentYearID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6160,
        -96
      ],
      "id": "63f09187-49c0-4982-bfaf-602be728746a",
      "name": "Append row in sheet5",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ===== 1. L·∫§Y ID C·ª¶A FOLDER NƒÇM T·ª™ NODE TR∆Ø·ªöC =====\n// ƒê·∫£m b·∫£o t√™n node 'Folder_nƒÉm' l√† ch√≠nh x√°c\nconst yearFolderId = $('Folder_nƒÉm').first().json.Folder_NƒÉm;\n\n// ===== 2. T√çNH TO√ÅN T√äN NƒÇM H·ªåC HI·ªÜN T·∫†I =====\nconst now = new Date();\n// NƒÉm h·ªçc m·ªõi b·∫Øt ƒë·∫ßu t·ª´ th√°ng 8 (getMonth() tr·∫£ v·ªÅ 7 cho th√°ng 8)\nconst startYear = now.getMonth() >= 7 ? now.getFullYear() : now.getFullYear() - 1;\nconst endYear = startYear + 1;\nconst yearName = `${startYear} - ${endYear}`;\n\n// ===== 3. T·∫†O M√É NƒÇM H·ªåC (YEAR ID) T·ª∞ ƒê·ªòNG =====\n// V√≠ d·ª•: NƒÉm h·ªçc 2025-2026 s·∫Ω c√≥ ID l√† \"SY2526\"\nconst yearId = `SY${startYear.toString().slice(-2)}${endYear.toString().slice(-2)}`;\n\n// ===== 4. GOM T·∫§T C·∫¢ TH√îNG TIN L·∫†I TH√ÄNH M·ªòT ƒê·ªêI T∆Ø·ª¢NG HO√ÄN CH·ªàNH =====\nconst newRow = {\n  YearID: yearId,\n  YearName: yearName,\n  YearFolderID: yearFolderId\n};\n\n// ===== 5. TR·∫¢ V·ªÄ K·∫æT QU·∫¢ ƒê√É ƒê∆Ø·ª¢C CHU·∫®N H√ìA =====\nreturn [{\n  json: newRow\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5952,
        -96
      ],
      "id": "a2c2873e-d97e-4419-b5e6-6c5ab889236e",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Grades",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "GradeID": "={{ $('Code in JavaScript1').item.json.expected_GradeID }}",
            "GradeName": "={{ $('Code in JavaScript1').item.json.expected_GradeName }}",
            "GradeFolderID": "={{ $('Code in JavaScript1').item.json.expected_GradeFolderID }}",
            "ParentYearID": "={{ $('Code in JavaScript1').item.json.expected_ParentYearID }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "GradeID",
              "displayName": "GradeID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "GradeName",
              "displayName": "GradeName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "GradeFolderID",
              "displayName": "GradeFolderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ParentYearID",
              "displayName": "ParentYearID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        7952,
        160
      ],
      "id": "0cde9e5d-411c-4322-bd47-655155d21848",
      "name": "Append row in sheet6",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Folder_nƒÉm').first().json['Folder_NƒÉm'] }}",
            "mode": "id"
          },
          "whatToSearch": "folders"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        7072,
        16
      ],
      "id": "1c38e366-0d38-4cf3-87ad-07594bf1665c",
      "name": "Search files and folders12",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Grades",
          "mode": "name"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        7280,
        16
      ],
      "id": "f2b6513a-735c-4a8a-ae92-fad6d9af6f10",
      "name": "Get row(s) in sheet4",
      "alwaysOutputData": true,
      "executeOnce": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ===== 1. L·∫§Y D·ªÆ LI·ªÜU V√Ä X√ÅC ƒê·ªäNH NƒÇM H·ªåC CHU·∫®N =====\nconst driveFolders = $('Search files and folders12').all();\nconst sheetRows = $('Get row(s) in sheet4').all();\n\nconst now = new Date();\nconst startYear = now.getMonth() >= 7 ? now.getFullYear() : now.getFullYear() - 1;\nconst endYear = startYear + 1;\nconst parentYearId = `SY${startYear.toString().slice(-2)}${endYear.toString().slice(-2)}`;\n\n// ===== 2. SO S√ÅNH V√Ä PH√ÇN LO·∫†I L·ªñI =====\nconst allErrors = [];\n\n// L·∫∑p qua t·ª´ng th∆∞ m·ª•c chu·∫©n tr√™n Google Drive\nfor (const driveItem of driveFolders) {\n  const driveFolder = driveItem.json;\n  const expectedGradeID = `G_${driveFolder.name.replace(/\\s+/g, '')}`;\n\n  // N√ÇNG C·∫§P LOGIC T√åM KI·∫æM:\n  // T√¨m m·ªôt d√≤ng trong Sheet kh·ªõp v·ªõi GradeID CHU·∫®N ho·∫∑c GradeName CHU·∫®N\n  const sheetRowObject = sheetRows.find(item => \n    item.json.GradeID === expectedGradeID || item.json.GradeName === driveFolder.name\n  );\n\n  // TR∆Ø·ªúNG H·ª¢P 1: HO√ÄN TO√ÄN KH√îNG T√åM TH·∫§Y D√íNG N√ÄO -> B√°o \"THI·∫æU\"\n  if (!sheetRowObject) {\n    allErrors.push({\n      status: 'THI·∫æU',\n      expected_GradeID: expectedGradeID,\n      expected_GradeName: driveFolder.name,\n      expected_GradeFolderID: driveFolder.id,\n      expected_ParentYearID: parentYearId\n    });\n    continue; // Chuy·ªÉn sang ki·ªÉm tra th∆∞ m·ª•c ti·∫øp theo\n  }\n  \n  // TR∆Ø·ªúNG H·ª¢P 2: T√åM TH·∫§Y D√íNG, TI·∫æN H√ÄNH KI·ªÇM TRA TO√ÄN DI·ªÜN -> B√°o \"SAI\" n·∫øu c·∫ßn\n  const sheetItem = sheetRowObject.json;\n\n  // Ki·ªÉm tra t·ª´ng tr∆∞·ªùng xem c√≥ b·ªã sai ho·∫∑c tr·ªëng kh√¥ng\n  const isGradeIdInvalid = !sheetItem.GradeID || sheetItem.GradeID !== expectedGradeID;\n  const isGradeNameInvalid = !sheetItem.GradeName || sheetItem.GradeName !== driveFolder.name;\n  const isFolderIdInvalid = !sheetItem.GradeFolderID || sheetItem.GradeFolderID !== driveFolder.id;\n  const isParentIdInvalid = !sheetItem.ParentYearID || sheetItem.ParentYearID !== parentYearId;\n\n  // N·∫øu c√≥ B·∫§T K·ª≤ l·ªói n√†o, ghi nh·∫≠n l√† \"SAI\"\n  if (isGradeIdInvalid || isGradeNameInvalid || isFolderIdInvalid || isParentIdInvalid) {\n    allErrors.push({\n      status: 'SAI',\n      row_number: sheetItem.row_number,\n      // D·ªØ li·ªáu mong mu·ªën (Expected)\n      expected_GradeID: expectedGradeID,\n      expected_GradeName: driveFolder.name,\n      expected_GradeFolderID: driveFolder.id,\n      expected_ParentYearID: parentYearId,\n      // D·ªØ li·ªáu th·ª±c t·∫ø (Actual)\n      actual_GradeID: sheetItem.GradeID,\n      actual_GradeName: sheetItem.GradeName,\n      actual_GradeFolderID: sheetItem.GradeFolderID,\n      actual_ParentYearID: sheetItem.ParentYearID\n    });\n  }\n}\n\n// ===== 3. TR·∫¢ V·ªÄ K·∫æT QU·∫¢ CU·ªêI C√ôNG =====\n\n// N·∫øu c√≥ l·ªói, tr·∫£ v·ªÅ m·ªói l·ªói l√† m·ªôt item ri√™ng bi·ªát\nif (allErrors.length > 0) {\n  return allErrors.map(item => ({ json: item }));\n}\n\n// N·∫øu kh√¥ng c√≥ l·ªói n√†o, tr·∫£ v·ªÅ tr·∫°ng th√°i \"OK\"\nreturn [{\n  json: {\n    status: 'OK',\n    message: 'D·ªØ li·ªáu Kh·ªëi h·ªçc ƒë√£ ƒë∆∞·ª£c ƒë·ªìng b·ªô ch√≠nh x√°c.'\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        7488,
        16
      ],
      "id": "f6b0ae07-2982-4cd5-a85f-880cc4bd393c",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.status }}",
                    "rightValue": "SAI",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "cae88292-b98f-4284-8966-479b77f31987"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "43668a36-afe9-4d3b-adea-faceb9eafe46",
                    "leftValue": "={{ $json.status }}",
                    "rightValue": "OK",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5a78695b-499e-4d57-99b0-6ec8177d4525",
                    "leftValue": "={{ $json.status }}",
                    "rightValue": "THI·∫æU",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        7728,
        0
      ],
      "id": "9c8f35b0-6e03-45f2-9de0-5add9c049a2c",
      "name": "Switch"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Grades",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.row_number }}",
            "GradeID": "={{ $json.expected_GradeID }}",
            "GradeName": "={{ $json.expected_GradeName }}",
            "GradeFolderID": "={{ $json.expected_GradeFolderID }}",
            "ParentYearID": "={{ $json.expected_ParentYearID }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "GradeID",
              "displayName": "GradeID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "GradeName",
              "displayName": "GradeName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "GradeFolderID",
              "displayName": "GradeFolderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ParentYearID",
              "displayName": "ParentYearID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        7952,
        -80
      ],
      "id": "bfd45ab7-e6e0-42c5-a17d-fb83339b1e26",
      "name": "Update row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ===== 1. T√çNH TO√ÅN D·ªÆ LI·ªÜU CHU·∫®N C·ª¶A NƒÇM H·ªåC HI·ªÜN T·∫†I =====\nconst now = new Date();\nconst startYear = now.getMonth() >= 7 ? now.getFullYear() : now.getFullYear() - 1;\nconst endYear = startYear + 1;\nconst expectedYearName = `${startYear} - ${endYear}`;\nconst expectedYearId = `SY${startYear.toString().slice(-2)}${endYear.toString().slice(-2)}`;\n\n// L·∫•y ID th∆∞ m·ª•c th·ª±c t·∫ø t·ª´ Google Drive\nconst driveFolder = $('Folder_nƒÉm').first().json;\nconst expectedFolderId = driveFolder ? driveFolder.Folder_NƒÉm : null;\n\n\n// ===== 2. L·∫§Y D·ªÆ LI·ªÜU T·ª™ INPUT V√Ä T√åM ƒê√öNG D√íNG TRONG SHEET =====\n\n// L·∫•y row_number t·ª´ ƒë·∫ßu v√†o (INPUT) c·ªßa node n√†y\nconst inputRowNumber = $input.item.json.row_number;\n\n// L·∫•y to√†n b·ªô danh s√°ch c√°c d√≤ng t·ª´ node \"Get row(s)\" ban ƒë·∫ßu\nconst allSheetRows = $('Get row(s) in sheet3').all();\n\n// D√πng row_number t·ª´ INPUT ƒë·ªÉ t√¨m ch√≠nh x√°c d√≤ng d·ªØ li·ªáu c·∫ßn ki·ªÉm tra\nconst foundYearRow = allSheetRows.find(item => item.json.row_number === inputRowNumber);\n\n\n// ===== 3. TI·∫æN H√ÄNH \"CH·∫®N ƒêO√ÅN\" V√Ä TR·∫¢ V·ªÄ K·∫æT LU·∫¨N =====\n\n// Tr∆∞·ªùng h·ª£p kh√¥ng mong mu·ªën: kh√¥ng t√¨m th·∫•y d√≤ng, d√π ƒë√£ c√≥ row_number\nif (!foundYearRow) {\n  return [{ json: { status: 'L·ªñI', message: `Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu cho d√≤ng s·ªë ${inputRowNumber}` } }];\n}\n\n// L·∫•y d·ªØ li·ªáu c·ªßa d√≤ng ƒë√£ t√¨m th·∫•y\nconst sheetItem = foundYearRow.json;\n\n// So s√°nh d·ªØ li·ªáu th·ª±c t·∫ø v·ªõi d·ªØ li·ªáu chu·∫©n\nconst isNameMismatched = sheetItem.YearName !== expectedYearName;\nconst isFolderIdMismatched = !sheetItem.YearFolderID || sheetItem.YearFolderID !== expectedFolderId;\n\n// N·∫øu c√≥ sai l·ªách\nif (isNameMismatched || isFolderIdMismatched) {\n  return [{\n    json: {\n      status: 'SAI L·ªÜCH',\n      row_number: inputRowNumber, // S·ª≠ d·ª•ng row_number t·ª´ INPUT\n      // D·ªØ li·ªáu mong mu·ªën (Expected)\n      expected_YearID: expectedYearId,\n      expected_YearName: expectedYearName,\n      expected_YearFolderID: expectedFolderId,\n      // D·ªØ li·ªáu th·ª±c t·∫ø (Actual)\n      actual_YearID: sheetItem.YearID,\n      actual_YearName: sheetItem.YearName,\n      actual_YearFolderID: sheetItem.YearFolderID\n    }\n  }];\n}\n\n// N·∫øu m·ªçi th·ª© HO√ÄN H·∫¢O\nreturn [{\n  json: {\n    status: 'HO√ÄN H·∫¢O',\n    message: 'D·ªØ li·ªáu nƒÉm h·ªçc ƒë√£ ƒë∆∞·ª£c c·∫•u h√¨nh ch√≠nh x√°c.'\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5952,
        96
      ],
      "id": "b71c1d1b-6b89-4420-97d6-55b55a92b67b",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "SchoolYears",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.row_number }}",
            "YearID": "={{ $json.expected_YearID }}",
            "YearName": "={{ $json.expected_YearName }}",
            "YearFolderID": "={{ $json.expected_YearFolderID }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "YearID",
              "displayName": "YearID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "YearName",
              "displayName": "YearName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "YearFolderID",
              "displayName": "YearFolderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ParentYearID",
              "displayName": "ParentYearID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6384,
        16
      ],
      "id": "7b2a90bd-bb3d-430e-b23b-6ab897b39064",
      "name": "Update row in sheet2",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ===== 1. T√çNH TO√ÅN M√É NƒÇM H·ªåC HI·ªÜN T·∫†I (CHU·∫®N) =====\nconst now = new Date();\nconst startYear = now.getMonth() >= 7 ? now.getFullYear() : now.getFullYear() - 1;\nconst endYear = startYear + 1;\nconst currentYearId = `SY${startYear.toString().slice(-2)}${endYear.toString().slice(-2)}`;\n\n// ===== 2. L·∫§Y DANH S√ÅCH C√ÅC NƒÇM H·ªåC ƒê√É C√ì T·ª™ SHEET =====\nconst existingYears = $input.all();\n\n// ===== 3. T√åM D√íNG D·ªÆ LI·ªÜU C·ª¶A NƒÇM H·ªåC HI·ªÜN T·∫†I =====\n// D√πng .find() ƒë·ªÉ t√¨m v√† l·∫•y ra to√†n b·ªô item kh·ªõp\nconst foundYearRow = existingYears.find(item => item.json.YearID === currentYearId);\n\n// ===== 4. TR·∫¢ V·ªÄ K·∫æT QU·∫¢ D·ª∞A TR√äN VI·ªÜC T√åM KI·∫æM =====\n\n// TR∆Ø·ªúNG H·ª¢P 1: N·∫øu T√åM TH·∫§Y nƒÉm h·ªçc (foundYearRow kh√¥ng r·ªóng)\nif (foundYearRow) {\n  return [{\n    json: {\n      exists: true,\n      row_number: foundYearRow.json.row_number // <-- Tr·∫£ v·ªÅ row_number c·ªßa d√≤ng ƒë√£ t√¨m th·∫•y\n    }\n  }];\n}\n\n// TR∆Ø·ªúNG H·ª¢P 2: N·∫øu KH√îNG T√åM TH·∫§Y nƒÉm h·ªçc\nreturn [{\n  json: {\n    exists: false\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5520,
        0
      ],
      "id": "99aa0f8d-fa9a-4956-a433-e940de99b20f",
      "name": "Code in JavaScript3"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "17b84c01-78e5-457b-a30b-6ae5818d08ee",
              "leftValue": "={{ $json.status }}",
              "rightValue": "SAI L·ªÜCH",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        6160,
        96
      ],
      "id": "f05e319c-7aa2-4136-bc78-9236b2e0d7f9",
      "name": "If12"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Classes",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "ClassName",
              "lookupValue": "={{ $('Edit Fields').first().json['L·ªõp h·ªçc'] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8384,
        96
      ],
      "id": "8ef4a48c-986f-49d8-9c24-a27b3978a5d1",
      "name": "Get row(s) in sheet5",
      "executeOnce": true,
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "operation": "clear",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "mode": "name",
          "value": "=Grades"
        },
        "clear": "specificRange",
        "range": "A2:Z"
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6384,
        -96
      ],
      "id": "7393b291-7e78-4cc0-b2ee-63c7e988efe1",
      "name": "Clear sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "operation": "clear",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "=Classes",
          "mode": "name"
        },
        "clear": "specificRange",
        "range": "A2:Z"
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6592,
        -96
      ],
      "id": "362bf5a6-7f73-4c19-8d56-8aa2e443f4ac",
      "name": "Clear sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "operation": "clear",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "=Students",
          "mode": "name"
        },
        "clear": "specificRange",
        "range": "A2:Z"
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6816,
        -96
      ],
      "id": "a1d4f757-8639-469c-8038-2c523651a412",
      "name": "Clear sheet2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ===== 1. L·∫§Y T·∫§T C·∫¢ C√ÅC ITEM ƒê√É ƒê∆Ø·ª¢C X·ª¨ L√ù T·ª™ TR∆Ø·ªöC =====\n// $input.all() s·∫Ω gom t·∫•t c·∫£ c√°c item ƒëi v√†o th√†nh m·ªôt danh s√°ch.\nconst processedItems = $input.all();\n\n// ===== 2. T·∫†O M·ªòT ƒê·ªêI T∆Ø·ª¢NG T√ìM T·∫ÆT DUY NH·∫§T =====\n// ƒê·ªëi t∆∞·ª£ng n√†y b√°o hi·ªáu r·∫±ng qu√° tr√¨nh l·∫∑p ƒë√£ ho√†n t·∫•t.\nconst summaryOutput = {\n  status: 'Completed',\n  itemsProcessed: processedItems.length,\n  message: `ƒê√£ ho√†n t·∫•t x·ª≠ l√Ω ${processedItems.length} m·ª•c.`\n};\n\n// ===== 3. TR·∫¢ V·ªÄ M·ªòT ITEM DUY NH·∫§T =====\n// B·∫±ng c√°ch ƒë·∫∑t ƒë·ªëi t∆∞·ª£ng t√≥m t·∫Øt v√†o trong m·ªôt m·∫£ng [ ... ],\n// ch√∫ng ta ƒë·∫£m b·∫£o node n√†y ch·ªâ c√≥ M·ªòT ƒë·∫ßu ra duy nh·∫•t.\nreturn [{\n  json: summaryOutput\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        8176,
        96
      ],
      "id": "54bc81a9-6577-4611-84ef-0a650960d890",
      "name": "Code in JavaScript4"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Classes",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "ClassID": "={{ $json.ClassID }}",
            "ClassName": "={{ $json.ClassName }}",
            "ClassFolderID": "={{ $json.ClassFolderID }}",
            "ParentGradeID": "={{ $json.ParentGradeID }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "ClassID",
              "displayName": "ClassID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ClassName",
              "displayName": "ClassName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ClassFolderID",
              "displayName": "ClassFolderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ParentGradeID",
              "displayName": "ParentGradeID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9440,
        192
      ],
      "id": "adb2fa47-28e8-4236-8855-0f1580f591cb",
      "name": "Append row in sheet7",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ===== 1. L·∫§Y D·ªÆ LI·ªÜU T·ª™ C√ÅC NGU·ªíN =====\n\n// L·∫•y th√¥ng tin chi ti·∫øt c·ªßa h·ªçc sinh t·ª´ node 'Edit Fields'\nconst studentInfo = $('Edit Fields').first().json;\nconst className = studentInfo['L·ªõp h·ªçc']; // V√≠ d·ª•: \"5A\"\n\n// L·∫•y ID c·ªßa th∆∞ m·ª•c L·ªõp v·ª´a ƒë∆∞·ª£c t·∫°o ·ªü b∆∞·ªõc tr∆∞·ªõc\nconst classFolderID = $('Folder_L·ªõp').first().json['Folder_L·ªõp'];\n\n// L·∫•y danh s√°ch c√°c Kh·ªëi t·ª´ ƒê·∫¶U V√ÄO TR·ª∞C TI·∫æP c·ªßa node n√†y\nconst gradeList = $input.first().json.danhSachData;\n\n\n// ===== 2. T√åM KI·∫æM TH√îNG TIN KH·ªêI CHA (PARENT GRADE) =====\n\n// Tr√≠ch xu·∫•t s·ªë t·ª´ t√™n l·ªõp ƒë·ªÉ t√¨m ki·∫øm (v√≠ d·ª•: \"5A\" -> \"5\")\nconst classNumberMatch = className.match(/\\d+/);\nlet parentGradeID = null; // Kh·ªüi t·∫°o l√† null ƒë·ªÉ x·ª≠ l√Ω n·∫øu kh√¥ng t√¨m th·∫•y\n\n// Ch·ªâ th·ª±c hi·ªán t√¨m ki·∫øm n·∫øu tr√≠ch xu·∫•t ƒë∆∞·ª£c s·ªë t·ª´ t√™n l·ªõp\nif (classNumberMatch) {\n  const classNumber = classNumberMatch[0];\n  const targetGradeName = `Kh·ªëi ${classNumber}`; // V√≠ d·ª•: \"Kh·ªëi 5\"\n\n  // D√πng h√†m .find() ƒë·ªÉ t√¨m ƒë·ªëi t∆∞·ª£ng Kh·ªëi ph√π h·ª£p trong danh s√°ch\n  const parentGradeInfo = gradeList.find(grade => grade.GradeName === targetGradeName);\n\n  // N·∫øu t√¨m th·∫•y, l·∫•y GradeID c·ªßa kh·ªëi ƒë√≥\n  if (parentGradeInfo) {\n    parentGradeID = parentGradeInfo.GradeID; // V√≠ d·ª•: \"G_Kh·ªëi5\"\n  }\n}\n\n\n// ===== 3. T·∫†O M√É L·ªöP H·ªåC (CLASS ID) T·ª∞ ƒê·ªòNG =====\n// T·∫°o ra m·ªôt ID duy nh·∫•t v√† c√≥ h·ªá th·ªëng, v√≠ d·ª•: \"C_5A_G_Kh·ªëi5\"\nconst classId = `C_${className.replace(/\\s+/g, '')}_${parentGradeID}`;\n\n\n// ===== 4. GOM T·∫§T C·∫¢ TH√îNG TIN L·∫†I =====\n// C√°c t√™n tr∆∞·ªùng ph·∫£i kh·ªõp ch√≠nh x√°c v·ªõi t√™n c·ªôt trong Sheet\nconst newRow = {\n  ClassID: classId,\n  ClassName: className,\n  ClassFolderID: classFolderID,\n  ParentGradeID: parentGradeID\n};\n\n\n// ===== 5. TR·∫¢ V·ªÄ K·∫æT QU·∫¢ ƒê√É ƒê∆Ø·ª¢C CHU·∫®N H√ìA =====\nreturn [{\n  json: newRow\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        9232,
        192
      ],
      "id": "a3b95405-b200-4bbd-93b0-3e9d027ed290",
      "name": "Code in JavaScript5"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Grades",
          "mode": "name"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        8800,
        192
      ],
      "id": "645bec4d-f3eb-4e67-b426-713a691823db",
      "name": "Get row(s) in sheet6",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "b72d4544-d5d9-4d51-a899-5a18d7f8d669",
              "leftValue": "={{ $json.ClassName }}",
              "rightValue": "={{ $('Edit Fields').first().json['L·ªõp h·ªçc'] }}",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        8592,
        96
      ],
      "id": "99853059-731d-463e-92cf-d256b624b4d1",
      "name": "If13"
    },
    {
      "parameters": {
        "jsCode": "// L·∫•y to√†n b·ªô danh s√°ch c√°c item t·ª´ ƒë·∫ßu v√†o.\nconst allItems = $input.all();\n\n// D√πng .map() ƒë·ªÉ tr√≠ch xu·∫•t ch·ªâ ph·∫ßn `json` (d·ªØ li·ªáu ch√≠nh) t·ª´ m·ªói item.\n// K·∫øt qu·∫£ l√† m·ªôt m·∫£ng s·∫°ch ch·ªâ ch·ª©a 4 object d·ªØ li·ªáu c·ªßa Anh.\nconst allData = allItems.map(item => item.json);\n\n// QUAN TR·ªåNG: G√≥i to√†n b·ªô m·∫£ng 'allData' v√†o b√™n trong M·ªòT item duy nh·∫•t.\n// C·∫•u tr√∫c `[{ json: { ... } }]` ch√≠nh l√† c√∫ ph√°p ƒë·ªÉ t·∫°o ra m·ªôt output c√≥ ƒë√∫ng 1 item.\nreturn [{\n  json: {\n    danhSachData: allData // Anh c√≥ th·ªÉ ƒë·ªïi t√™n key 'danhSachData' th√†nh b·∫•t c·ª© g√¨ Anh mu·ªën\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        9008,
        192
      ],
      "id": "fa2f890b-b927-4845-aaa0-45b1b4ffb4d4",
      "name": "Code in JavaScript6"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Students",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "StudentID",
              "lookupValue": "={{ $('Edit Fields').first().json['M√£ h·ªçc sinh'] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9872,
        80
      ],
      "id": "6cb6be29-3fbe-4e94-aabc-10f02cd048bf",
      "name": "Get row(s) in sheet7",
      "executeOnce": true,
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Classes",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "ClassName",
              "lookupValue": "={{ $('Edit Fields').first().json['L·ªõp h·ªçc'] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        9664,
        80
      ],
      "id": "0e9f4ad0-f304-43c8-b817-77c899ff383f",
      "name": "Get row(s) in sheet8",
      "executeOnce": true,
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "b72d4544-d5d9-4d51-a899-5a18d7f8d669",
              "leftValue": "={{ $json.ClassName }}",
              "rightValue": "={{ $('Edit Fields').first().json['L·ªõp h·ªçc'] }}",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        10080,
        80
      ],
      "id": "c0a648b2-6ed3-4951-b2b0-942a9e961974",
      "name": "If14"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders9').first().json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Students",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "StudentID": "={{ $json.StudentID }}",
            "StudentName": "={{ $json.StudentName }}",
            "StudentFolderID": "={{ $json.StudentFolderID }}",
            "ParentClassID": "={{ $json.ParentClassID }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "StudentID",
              "displayName": "StudentID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "StudentName",
              "displayName": "StudentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "StudentFolderID",
              "displayName": "StudentFolderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ParentClassID",
              "displayName": "ParentClassID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        10496,
        160
      ],
      "id": "cdab4b26-f86e-4cb6-a079-d3792cbfac4e",
      "name": "Append row in sheet8",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ===== 1. L·∫§Y D·ªÆ LI·ªÜU T·ª™ C√ÅC NGU·ªíN ƒê·∫¶U V√ÄO =====\n\n// L·∫•y th√¥ng tin chi ti·∫øt c·ªßa h·ªçc sinh t·ª´ node 'Edit Fields'.\nconst studentInfo = $('Edit Fields').first().json;\n\n// L·∫•y th√¥ng tin chi ti·∫øt c·ªßa l·ªõp h·ªçc t·ª´ node 'Get row(s) in sheet8'.\nconst classInfo = $('Get row(s) in sheet8').first().json;\n\n// L·∫•y ID th∆∞ m·ª•c c·ªßa h·ªçc sinh.\nconst studentFolderId = $('Edit Fields3').first().json['FOLDER_H·ªçc_sinh'];\n\n\n// ===== 2. T·∫†O ƒê·ªêI T∆Ø·ª¢NG D·ªÆ LI·ªÜU M·ªöI THEO ƒê√öNG C·∫§U TR√öC SHEET =====\n\n// !!! THAY ƒê·ªîI ·ªû ƒê√ÇY: K·∫øt h·ª£p t√™n v√† email ƒë·ªÉ t·∫°o StudentName m·ªõi\n// Gi·∫£ ƒë·ªãnh tr∆∞·ªùng email trong node 'Edit Fields' c√≥ t√™n l√† 'Gmail'.\nconst newStudentName = `${studentInfo['H·ªç v√† t√™n']} - ${studentInfo['Gmail']}`;\n\nconst newRow = {\n  StudentID: studentInfo['M√£ h·ªçc sinh'],\n  StudentName: newStudentName, // <-- S·ª≠ d·ª•ng gi√° tr·ªã m·ªõi ƒë√£ ƒë∆∞·ª£c k·∫øt h·ª£p\n  StudentFolderID: studentFolderId,\n  ParentClassID: classInfo.ClassID\n};\n\n\n// ===== 3. TR·∫¢ V·ªÄ K·∫æT QU·∫¢ =====\n// Tr·∫£ v·ªÅ m·ªôt item duy nh·∫•t ch·ª©a ƒë·ªëi t∆∞·ª£ng 'newRow', s·∫µn s√†ng cho node 'Append row'.\nreturn [{\n  json: newRow\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10288,
        160
      ],
      "id": "d9b2f875-a76f-419b-9be4-2b9e4b7d11a0",
      "name": "Code in JavaScript7"
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "[ADMIN] Master Control Sheet",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Search files and folders3').item.json.id }}",
            "mode": "id"
          },
          "whatToSearch": "files",
          "fileTypes": [
            "application/vnd.google-apps.spreadsheet"
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -176,
        112
      ],
      "id": "b3a12a3c-6ad4-4eb8-8cd2-11eef0d48d28",
      "name": "Search files and folders5",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "={{ $json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Students",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "StudentName",
              "lookupValue": "={{ $('Edit Fields').item.json['H·ªç v√† t√™n'] }} - {{ $('Edit Fields').item.json.Gmail }}"
            }
          ]
        },
        "combineFilters": "OR",
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        256,
        -144
      ],
      "id": "4bfe3481-1f70-42dc-91ad-7de8161016f9",
      "name": "Get row(s) in sheet",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ===== 1. L·∫§Y D·ªÆ LI·ªÜU NH·∫¨P V√ÄO T·ª™ NODE 'EDIT FIELDS' =====\n// L·∫•y th√¥ng tin ng∆∞·ªùi d√πng m·ªõi nh·∫≠p v√† chu·∫©n h√≥a v·ªÅ ch·ªØ th∆∞·ªùng ngay l·∫≠p t·ª©c.\nconst userInput = $('Edit Fields').first().json;\nconst inputName = userInput['H·ªç v√† t√™n'].toLowerCase();\nconst inputGmail = userInput['Gmail'].toLowerCase();\n\n// ===== 2. L·∫§Y DANH S√ÅCH H·ªåC SINH HI·ªÜN C√ì T·ª™ GOOGLE SHEET =====\n// L·∫•y t·∫•t c·∫£ c√°c h√†ng d·ªØ li·ªáu t·ª´ ƒë·∫ßu v√†o tr·ª±c ti·∫øp (node 'Get row(s) in sheet').\nconst existingStudents = $input.all();\n\n// ===== 3. T√åM KI·∫æM H·ªåC SINH TR√ôNG KH·ªöP =====\n// !!! THAY ƒê·ªîI: D√πng .find() thay v√¨ .some()\n// .find() s·∫Ω tr·∫£ v·ªÅ TO√ÄN B·ªò item ƒë·∫ßu ti√™n kh·ªõp ƒëi·ªÅu ki·ªán, ho·∫∑c 'undefined' n·∫øu kh√¥ng t√¨m th·∫•y.\nconst matchedStudent = existingStudents.find(studentItem => {\n  // L·∫•y tr∆∞·ªùng 'StudentName' t·ª´ m·ªói h√†ng trong sheet.\n  const studentNameFromSheet = studentItem.json.StudentName;\n\n  // Ki·ªÉm tra an to√†n, n·∫øu kh√¥ng c√≥ StudentName th√¨ b·ªè qua.\n  if (!studentNameFromSheet) {\n    return false;\n  }\n\n  // T√°ch chu·ªói \"T√™n - Gmail\" th√†nh m·ªôt m·∫£ng g·ªìm 2 ph·∫ßn.\n  const parts = studentNameFromSheet.split(' - ');\n\n  // N·∫øu d·ªØ li·ªáu trong sheet kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng (v√≠ d·ª• thi·∫øu email), b·ªè qua.\n  if (parts.length < 2) {\n    return false;\n  }\n\n  // L·∫•y ra t√™n v√† email t·ª´ d·ªØ li·ªáu sheet v√† chu·∫©n h√≥a.\n  const existingName = parts[0].trim().toLowerCase();\n  const existingEmail = parts[1].trim().toLowerCase();\n\n  // So s√°nh c√°c gi√° tr·ªã ƒë√£ ƒë∆∞·ª£c chu·∫©n h√≥a ho√†n to√†n.\n  return existingName === inputName && existingEmail === inputGmail;\n});\n\n// ===== 4. TR·∫¢ V·ªÄ K·∫æT QU·∫¢ D·ª∞A TR√äN VI·ªÜC T√åM KI·∫æM =====\n// Ki·ªÉm tra xem ch√∫ng ta c√≥ t√¨m th·∫•y h·ªçc sinh n√†o kh√¥ng.\nif (matchedStudent) {\n  // TR∆Ø·ªúNG H·ª¢P 1: T√åM TH·∫§Y\n  // Tr·∫£ v·ªÅ match: true v√† c·∫£ StudentID c·ªßa h·ªçc sinh ƒë√≥.\n  return [{\n    json: {\n      match: true,\n      StudentID: matchedStudent.json.StudentID\n    }\n  }];\n} else {\n  // TR∆Ø·ªúNG H·ª¢P 2: KH√îNG T√åM TH·∫§Y\n  // Tr·∫£ v·ªÅ match: false nh∆∞ c≈©.\n  return [{\n    json: {\n      match: false\n    }\n  }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -112,
        -432
      ],
      "id": "07849635-69ed-4543-9e91-47ed1bde0a47",
      "name": "Code in JavaScript8"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "51004b9e-5c44-4da2-9f7d-33c6378d326a",
              "leftValue": "={{ $json.match }}",
              "rightValue": "false",
              "operator": {
                "type": "boolean",
                "operation": "false",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        96,
        -464
      ],
      "id": "010951bc-193f-4023-9791-958348efae01",
      "name": "If1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "bc9d85e6-096e-41bf-b537-a10ccd550537",
              "leftValue": "={{ $('Edit Fields').item.json['StudentId_c·∫≠p_nh·∫≠t'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -416,
        96
      ],
      "id": "4de82fb1-c848-44a0-9b18-5bbcc54deaf1",
      "name": "If2"
    },
    {
      "parameters": {
        "content": "nh√°nh if ki·ªÉm tra xem ƒë√¢y l√† ng∆∞·ªùi d√πng c·∫≠p nh·∫≠t th√¥ng tin hay ƒëƒÉng k√Ω th√¥ng tin m·ªõi"
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -368,
        -672
      ],
      "id": "0d74a882-e1f5-4154-b2e5-0f46fc71debe",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "ki·ªÉm tra n·∫øu id kh√¥ng t·ªìn t·∫°i trong d·ªØ li·ªáu n·∫øu c·∫≠p nh·∫≠t th√¥ng tin"
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        176,
        -672
      ],
      "id": "f46289d2-cc16-44e6-ba70-70626213c29e",
      "name": "Sticky Note1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        640,
        -672
      ],
      "id": "f6b496b1-6a13-4436-bc96-69616986a0bc",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "1b79b463-ae8d-4a0a-9570-6f6e07866b46",
              "leftValue": "={{ Object.keys($json).length }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        480,
        -144
      ],
      "id": "2f9f47e1-ba08-49ee-831e-bcc1939cd014",
      "name": "If8"
    },
    {
      "parameters": {
        "resource": "fileFolder",
        "queryString": "[ADMIN] Master Control Sheet",
        "filter": {
          "folderId": {
            "__rl": true,
            "value": "={{ $('Search files and folders3').item.json.id }}",
            "mode": "id"
          },
          "whatToSearch": "files",
          "fileTypes": [
            "application/vnd.google-apps.spreadsheet"
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -176,
        -144
      ],
      "id": "7ed0e106-5da9-4f19-92d3-da7611e5c004",
      "name": "Search files and folders8",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "Fu9XdVE4G8qIVwID",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "={{ $json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Students",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "StudentID",
              "lookupValue": "={{ $('Edit Fields').item.json['StudentId_c·∫≠p_nh·∫≠t'] }}"
            },
            {
              "lookupColumn": "StudentName",
              "lookupValue": "={{ $('Edit Fields').item.json['H·ªç v√† t√™n'] }} - {{ $('Edit Fields').item.json.Gmail }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        48,
        112
      ],
      "id": "60e1a5b4-2b8a-4155-856b-31b72c5e5443",
      "name": "Get row(s) in sheet1",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "1b79b463-ae8d-4a0a-9570-6f6e07866b46",
              "leftValue": "={{ Object.keys($json).length }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        272,
        112
      ],
      "id": "87804941-6d7e-42cb-9861-4ebe82a3b432",
      "name": "If9"
    },
    {
      "parameters": {
        "sendTo": "={{ $('Edit Fields').first().json.Gmail }}",
        "subject": "X√°c nh·∫≠n th√¥ng tin ƒë√£ t·ªìn t·∫°i",
        "message": "=<!DOCTYPE html>\n<html lang=\"vi\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>L·ªói C·∫≠p nh·∫≠t - Kh√¥ng t√¨m th·∫•y Th√¥ng tin</title>\n</head>\n<body style=\"margin: 0; padding: 0; background-color: #f4f4f4; font-family: Arial, sans-serif;\">\n    <table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"background-color: #f4f4f4;\">\n        <tr>\n            <td align=\"center\">\n                <div style=\"max-width: 600px; margin: 20px auto; background-color: #ffffff; padding: 30px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);\">\n                    <h1 style=\"color: #d9534f; text-align: center; border-bottom: 2px solid #eeeeee; padding-bottom: 20px; margin-top: 0;\">\n                        L·ªói: Kh√¥ng T√¨m Th·∫•y Th√¥ng Tin\n                    </h1>\n                    <p style=\"font-size: 16px; color: #555555; line-height: 1.6;\">\n                        Ch√†o Anh/Ch·ªã,\n                    </p>\n                    <p style=\"font-size: 16px; color: #555555; line-height: 1.6;\">\n                        H·ªá th·ªëng ƒë√£ nh·∫≠n ƒë∆∞·ª£c y√™u c·∫ßu nh∆∞ng kh√¥ng th·ªÉ t√¨m th·∫•y h·ªì s∆° n√†o kh·ªõp v·ªõi c√°c ti√™u ch√≠ Anh/Ch·ªã ƒë√£ cung c·∫•p.\n                    </p>\n                    \n                    <div style=\"background-color: #f9f9f9; border: 1px solid #e0e0e0; border-radius: 8px; margin: 25px 0; padding: 20px;\">\n                        <h3 style=\"color: #4285f4; margin-top: 0; text-align: center; margin-bottom: 20px;\">Th√¥ng tin ƒë√£ ƒë∆∞·ª£c d√πng ƒë·ªÉ t√¨m ki·∫øm</h3>\n                        <p style=\"font-size: 16px; color: #333; line-height: 1.8; margin: 10px 0;\">\n                            <strong>M√£ h·ªçc sinh:</strong> {{ $('Edit Fields').first().json[\"M√£ h·ªçc sinh\"] }}\n                        </p>\n                        <p style=\"font-size: 16px; color: #333; line-height: 1.8; margin: 10px 0;\">\n                            <strong>Gmail:</strong> {{ $('Edit Fields').first().json.Gmail }}\n                        </p>\n                    </div>\n\n                    <p style=\"font-size: 16px; color: #555555; line-height: 1.6;\">\n                        <strong>Vui l√≤ng th·ª±c hi·ªán c√°c b∆∞·ªõc sau:</strong>\n                    </p>\n                    <p style=\"font-size: 16px; color: #555555; line-height: 1.6; margin-left: 20px;\">\n                        1. <strong>Ki·ªÉm tra l·∫°i th√¥ng tin:</strong> ƒê·∫£m b·∫£o r·∫±ng c√°c th√¥ng tin ƒë√£ nh·∫≠p l√† ch√≠nh x√°c v√† kh√¥ng c√≥ l·ªói ch√≠nh t·∫£.\n                    </p>\n                    <p style=\"font-size: 16px; color: #555555; line-height: 1.6; margin-left: 20px;\">\n                        2. <strong>Th√™m m·ªõi:</strong> N·∫øu ƒë√¢y l√† m·ªôt h·ªì s∆° ch∆∞a c√≥ trong h·ªá th·ªëng, vui l√≤ng kh√¥ng nh·∫≠p v√†o √¥ \"M√£ h·ªçc sinh\".\n                    </p>\n                    \n                    <p style=\"font-size: 14px; color: #888888; line-height: 1.6; margin-top: 30px; text-align: center; border-top: 1px solid #eeeeee; padding-top: 20px;\">\n                        N·∫øu Anh/Ch·ªã c·∫ßn h·ªó tr·ª£ th√™m, vui l√≤ng li√™n h·ªá b·ªô ph·∫≠n k·ªπ thu·∫≠t.\n                    </p>\n                </div>\n            </td>\n        </tr>\n    </table>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        528,
        320
      ],
      "id": "4700e576-33f7-496f-85fc-84b8fa893705",
      "name": "Send a message5",
      "webhookId": "e57cf627-15d0-4b3f-b887-1f0d6f351e86",
      "executeOnce": true,
      "credentials": {
        "gmailOAuth2": {
          "id": "kngvm6WXlbqXMFKV",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Search files and folders5').item.json.id }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "=Students",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "StudentID": "={{ $('Edit Fields').item.json['StudentId_c·∫≠p_nh·∫≠t'] }}",
            "StudentName": "={{ $json.StudentName }}",
            "StudentFolderID": "={{ $json.StudentFolderID }}",
            "ParentClassID": "={{ $json.ParentClassID }}"
          },
          "matchingColumns": [
            "StudentID"
          ],
          "schema": [
            {
              "id": "StudentID",
              "displayName": "StudentID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "StudentName",
              "displayName": "StudentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "StudentFolderID",
              "displayName": "StudentFolderID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ParentClassID",
              "displayName": "ParentClassID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4304,
        272
      ],
      "id": "704a2d7a-f97f-45a5-a364-a64daa25d472",
      "name": "Update row in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "Kc5JFDPfTGzxNbNi",
          "name": "duong.na.2719@aptechlearning.edu.vn"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ===== 1. L·∫§Y D·ªÆ LI·ªÜU T·ª™ C√ÅC NGU·ªíN ƒê·∫¶U V√ÄO =====\n\n// L·∫•y th√¥ng tin chi ti·∫øt c·ªßa h·ªçc sinh t·ª´ node 'Edit Fields'.\nconst studentInfo = $('Edit Fields').first().json;\n\n// L·∫•y ID th∆∞ m·ª•c c·ªßa h·ªçc sinh t·ª´ node 'Search files and folders3'.\nconst studentFolderId = $('Folder_L·ªõp').first().json['Folder_L·ªõp'];\n\n\n// ===== 2. X·ª¨ L√ù V√Ä T·∫†O D·ªÆ LI·ªÜU M·ªöI =====\n\n// 2.1. K·∫øt h·ª£p t√™n v√† email ƒë·ªÉ t·∫°o StudentName\nconst newStudentName = `${studentInfo['H·ªç v√† t√™n']} - ${studentInfo['Gmail']}`;\n\n// 2.2. T·∫†O ParentClassID THEO C·∫§U TR√öC - ƒê√É S·ª¨A L·ªñI\n// L·∫•y t√™n l·ªõp, v√≠ d·ª•: \"5A\"\nconst className = studentInfo['L·ªõp h·ªçc']; \n// T·ª± ƒë·ªông suy lu·∫≠n ra s·ªë kh·ªëi b·∫±ng c√°ch l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa t√™n l·ªõp\nconst gradeNumber = className.charAt(0); // L·∫•y k√Ω t·ª± t·∫°i v·ªã tr√≠ 0, k·∫øt qu·∫£ l√† \"5\"\n\n// Gh√©p chu·ªói ƒë·ªÉ t·∫°o ra ID l·ªõp cha ho√†n ch·ªânh\nconst newParentClassID = `C_${className}_G_Kh·ªëi${gradeNumber}`; // K·∫øt qu·∫£ mong mu·ªën: \"C_5A_G_Kh·ªëi5\"\n\n\n// ===== 3. T·∫†O ƒê·ªêI T∆Ø·ª¢NG D·ªÆ LI·ªÜU M·ªöI THEO ƒê√öNG C·∫§U TR√öC SHEET =====\n\nconst newRow = {\n  StudentID: studentInfo['M√£ h·ªçc sinh'],\n  StudentName: newStudentName,\n  StudentFolderID: studentFolderId,\n  ParentClassID: newParentClassID // <-- S·ª≠ d·ª•ng gi√° tr·ªã m·ªõi v·ª´a ƒë∆∞·ª£c t·∫°o ch√≠nh x√°c\n};\n\n\n// ===== 4. TR·∫¢ V·ªÄ K·∫æT QU·∫¢ =====\nreturn [{\n  json: newRow\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4096,
        272
      ],
      "id": "c0013d0a-7ea0-4a78-a701-b7c8795561fe",
      "name": "Code in JavaScript11"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        48,
        -144
      ],
      "id": "b859595d-5304-46c5-8d7c-60a74cfb746b",
      "name": "Code in JavaScript9"
    }
  ],
  "pinData": {},
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Search files and folders3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet1": {
      "main": [
        [
          {
            "node": "Search files and folders9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Create folder",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Folder_nƒÉm",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create folder": {
      "main": [
        [
          {
            "node": "Folder_nƒÉm",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders3": {
      "main": [
        [
          {
            "node": "Search files and folders6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders6": {
      "main": [
        [
          {
            "node": "Search files and folders7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders7": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code1": {
      "main": [
        [
          {
            "node": "Search files and folders",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If3": {
      "main": [
        [
          {
            "node": "Create folder1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Folder_Kh·ªëi",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create folder1": {
      "main": [
        [
          {
            "node": "Folder_Kh·ªëi",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders": {
      "main": [
        [
          {
            "node": "If3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Folder_nƒÉm": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders2": {
      "main": [
        [
          {
            "node": "If4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If4": {
      "main": [
        [
          {
            "node": "Create folder2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Folder_L·ªõp",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create folder2": {
      "main": [
        [
          {
            "node": "Folder_L·ªõp",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Folder_Kh·ªëi": {
      "main": [
        [
          {
            "node": "Search files and folders2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Folder_L·ªõp": {
      "main": [
        [
          {
            "node": "Search files and folders4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders4": {
      "main": [
        [
          {
            "node": "If5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If5": {
      "main": [
        [
          {
            "node": "Create spreadsheet",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create spreadsheet": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet": {
      "main": [
        [
          {
            "node": "Move file1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Move file1": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields2": {
      "main": [
        [
          {
            "node": "If7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders1": {
      "main": [
        [
          {
            "node": "If6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If6": {
      "main": [
        [
          {
            "node": "Create folder3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create folder3": {
      "main": [
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields3": {
      "main": [
        [
          {
            "node": "Append row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Share folder": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If7": {
      "main": [
        [
          {
            "node": "Search files and folders1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders9": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet3": {
      "main": [
        [
          {
            "node": "Code in JavaScript3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If11": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Append row in sheet5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet5": {
      "main": [
        [
          {
            "node": "Clear sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders12": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet4": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Update row in sheet",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Append row in sheet6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet6": {
      "main": [
        [
          {
            "node": "Code in JavaScript4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet": {
      "main": [
        [
          {
            "node": "Code in JavaScript4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "If12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript3": {
      "main": [
        [
          {
            "node": "If11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If12": {
      "main": [
        [
          {
            "node": "Update row in sheet2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet2": {
      "main": [
        [
          {
            "node": "Search files and folders12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet5": {
      "main": [
        [
          {
            "node": "If13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Clear sheet": {
      "main": [
        [
          {
            "node": "Clear sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Clear sheet1": {
      "main": [
        [
          {
            "node": "Clear sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Clear sheet2": {
      "main": [
        [
          {
            "node": "Search files and folders12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript4": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript5": {
      "main": [
        [
          {
            "node": "Append row in sheet7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet6": {
      "main": [
        [
          {
            "node": "Code in JavaScript6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If13": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet8",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get row(s) in sheet6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript6": {
      "main": [
        [
          {
            "node": "Code in JavaScript5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet7": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet8": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet7": {
      "main": [
        [
          {
            "node": "If14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript7": {
      "main": [
        [
          {
            "node": "Append row in sheet8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If14": {
      "main": [
        [
          {
            "node": "Share folder",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code in JavaScript7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet8": {
      "main": [
        [
          {
            "node": "Share folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search files and folders5": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "If8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript8": {
      "main": [
        []
      ]
    },
    "If1": {
      "main": [
        [],
        []
      ]
    },
    "If2": {
      "main": [
        [
          {
            "node": "Search files and folders8",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Search files and folders5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If8": {
      "main": [
        [
          {
            "node": "Send a message3",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "Send a message3": {
      "main": [
        []
      ]
    },
    "Search files and folders8": {
      "main": [
        [
          {
            "node": "Code in JavaScript9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet1": {
      "main": [
        [
          {
            "node": "If9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If9": {
      "main": [
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send a message5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript11": {
      "main": [
        [
          {
            "node": "Update row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet1": {
      "main": [
        [
          {
            "node": "Send a message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript9": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "c7e55804-f4e5-418f-ad29-0a82bc490e1c",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "df75f6d19da9532b87ea5a84541b4ccc1d0dd5baf896242962b0dfcbc492bcf4"
  },
  "id": "IH3rXBSQlLpA8wV2",
  "tags": []
}